<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[blog.koba04.com]]></title>
  <link href="http://blog.koba04.com/atom.xml" rel="self"/>
  <link href="http://blog.koba04.com/"/>
  <updated>2016-03-09T13:38:07+09:00</updated>
  <id>http://blog.koba04.com/</id>
  <author>
    <name><![CDATA[koba04]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[React.js v0.15 changes]]></title>
    <link href="http://blog.koba04.com/post/2016/03/09/react-js-v15-changes/"/>
    <updated>2016-03-09T13:07:52+09:00</updated>
    <id>http://blog.koba04.com/post/2016/03/09/react-js-v15-changes</id>
    <content type="html"><![CDATA[<p>React.js v15のRC版がリリースされたので変更内容などを整理したいと思います。</p>

<p><a href="https://facebook.github.io/react/blog/2016/03/07/react-v15-rc1.html">https://facebook.github.io/react/blog/2016/03/07/react-v15-rc1.html</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>% npm install --save react@15.0.0-rc.1 react-dom@15.0.0-rc.1</span></code></pre></td></tr></table></div></figure>


<p>今回の一番大きな変更はバージョン番号かなと思います。</p>

<p>0.14から15に。</p>

<p>0.x系だとproduction readyではないと思われることから一気に15.0になりましたが0.がなくなっただけで大きな変化があるわけでもないです。
なぜ1.0ではないのかというと1.0というバージョン番号は特別意味のあるものとして扱われるので、そうではなくてすでにproduction readyでありsemverに従っているということを明確にするために0.を取って15.0になりました。</p>

<p><a href="https://facebook.github.io/react/blog/2016/02/19/new-versioning-scheme.html">https://facebook.github.io/react/blog/2016/02/19/new-versioning-scheme.html</a></p>

<p>ちなみにこれまでもminor version(0.13 &ndash;> 0.14)などでは破壊的な変更がありましたがpatch version(0.14.1 &ndash;> 0.14.2)などは基本的には破壊的な変更はなかったのでバージョンアップのサイクルなどが変わることはないと思います。
（patch versionの更新でUndocumentedなfeatureで破壊的な変更が入ることはありましたが&hellip;）</p>

<p>これまでも破壊的な変更をする際は基本的には前のバージョンでwarningを入れてから更新するので、今回もすでに0.14.7を使っていて特にwarningなどが出力されていないのであれば問題なく15.0にアップデートできると思います。</p>

<!-- more -->


<p>ちなみにIE8のサポートについてはまだIE8対応のコードは削除されていないので動作するはずですが、今後はIE8のためだけのバグFixなどは行わないというステータスです。</p>

<p><a href="https://facebook.github.io/react/blog/2016/01/12/discontinuing-ie8-support.html">https://facebook.github.io/react/blog/2016/01/12/discontinuing-ie8-support.html</a></p>

<h2>Major changes</h2>

<h3>document.createElement is in and data-reactid is out</h3>

<p>これまではReactで構築した全てのDOMに対して<code>data-reactid</code>という属性が付与されていましたがそれが付与されなくなりました。すっきりしていいですね。
ReactDOM.renderを行ったルートの要素には<code>data-reactroot</code>という属性が付与されます。</p>

<p>またこれまでは多くの場合で<code>document.createElement</code>を使うよりも高速であるという理由から初期マウント時にはHTML文字列を生成してinnerHTMLで流し込んでいましたが、ブラウザーの改善などにより必ずしもそうとも言えなくなってきたので<code>document.createElement</code>を使って作成するように変更されました。</p>

<p><code>data-reactid</code>がなぜ必要だったのかはReactのイベントの仕組みに関係しています。
ReactではイベントハンドリングはそれぞれのReactElementと対応付けられたDOM要素にイベントリスナーを登録してハンドリングするのではなく、<code>ReactDOM.render</code>で指定したルートのDOM要素だけにイベントリスナーを登録してそこで全てのイベントをハンドリングしています。
ルートで受け取ったイベントがどのReactElementと対応付けられたDOMで発生したのかを判定するために<code>data-reactid</code>が使用されていました。</p>

<p>イベントは頻繁に発生するため内部ではキャッシュなどを駆使して高速化が図られていたのですがそれによるバグも多く、今回HTML文字列ではなくDOM要素を作成するようになり、DOM要素を保持しておけばいいので<code>data-reactid</code>を使ったマッピング情報を保持しておく必要がなくなりました。</p>

<p>ちなみに<code>ReactDOM.renderToString</code>を使って生成したHTML文字列には変わらず<code>data-reactid</code>が付与されています。</p>

<h3>No more extra <code>&lt;span&gt;</code>s</h3>

<p><code>{name}</code>などのように変数を文字列として埋め込んだ際にこれまでは差分更新のために<code>span</code>タグで囲まれていたのがcomment nodeに変更されました。</p>

<ul>
<li>v0.14</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;app&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">data-reactid=</span><span class="s">&quot;.0&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;span</span> <span class="na">data-reactid=</span><span class="s">&quot;.0.0&quot;</span><span class="nt">&gt;</span>Hello <span class="nt">&lt;/span&gt;</span>
</span><span class='line'><span class="nt">&lt;span</span> <span class="na">data-reactid=</span><span class="s">&quot;.0.1&quot;</span><span class="nt">&gt;</span>React<span class="nt">&lt;/span&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>v15</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;app&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">data-reactroot=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="c">&lt;!-- react-text: 2 --&gt;</span>Hello <span class="c">&lt;!-- /react-text --&gt;</span>
</span><span class='line'><span class="c">&lt;!-- react-text: 3 --&gt;</span>React<span class="c">&lt;!-- /react-text --&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>この変更はマークアップ構造の変更を生むので更新する際には注意が必要です。
特にCSS周りやテストでspanが挿入されることに依存したコードを書いていると壊れます。</p>

<p>元々が意図しないマークアップが挿入されていたのでそれがなくなってよかったんじゃないでしょうか。</p>

<h3>Rendering null now uses comment nodes</h3>

<p>renderメソッドでnullを返した場合に、これまでは<code>&lt;noscript&gt;</code>タグがrenderされていましたがcomment nodeに変更されました。
この変更もマークアップ構造の変更を生むので特に<code>:nth-child</code>などのセレクターを使っている場合には注意が必要です。</p>

<p>また下記のエントリーにもあるように無駄に<code>&lt;noscript&gt;</code>タグが更新されていたような場合に対するパフォーマンスの改善となります。</p>

<p><a href="http://benchling.engineering/deep-dive-react-perf-debugging/">http://benchling.engineering/deep-dive-react-perf-debugging/</a></p>

<h3>Improved SVG support</h3>

<p>全てのSVGタグがサポートされるようになりました。一般的ではないタグは<code>React.DOM</code>のヘルパーとしては提供されていませんが、<code>React.createElement</code>で全てのSVGタグを作成できます。
全てのSVGタグはキャメルケースやハイフンなどそのままの指定で作成できます。
<code>gradientTransform</code>は<code>gradientTransform</code>のままで<code>clip-path</code>は<code>clip-path</code>のまま指定します。</p>

<p>ちなみにクラスを指定する場合は<code>className</code>ではなくて、<code>class</code>で指定します。custom elementsと同じです。
それに関するissueはこちら。</p>

<p><a href="https://github.com/facebook/react/issues/6211">https://github.com/facebook/react/issues/6211</a></p>

<h2>Breaking changes</h2>

<p>v15で最も大きなBreaking changeは上に書いたspanタグを使わなくなったことによるマークアップ構造の変化です。</p>

<p>その他では、v0.14でwaringsを出力していたDeprecatedなAPIが完全に削除されました。</p>

<ul>
<li><p>Reactのパッケージから<code>findDOMNode</code>, <code>render</code>, <code>renderToString</code>, <code>renderToStaticMarkup</code>, <code>unmountComponentAtNode</code>が削除されました。代わりにReactDOMのパッケージにある同名のAPIを使います。</p></li>
<li><p>Addonとして提供されていた<code>batchedUpdates</code>と<code>cloneWithProps</code>が削除されました。</p></li>
<li><p><code>setProps</code>, <code>replaceProps</code>, <code>getDOMNode</code>のAPIが削除されました。</p></li>
</ul>


<h2>New deprecations, introduced with a warning</h2>

<p><code>LinkedStateMixin</code>と<code>valueLink</code>はほとんど使われておらず、v16で廃止するためのwarningを追加されます。</p>

<p><a href="https://facebook.github.io/react/docs/two-way-binding-helpers.html">https://facebook.github.io/react/docs/two-way-binding-helpers.html</a></p>

<p>必要な場合は下記のパッケージを利用してください。</p>

<p><a href="https://www.npmjs.com/package/react-linked-input">https://www.npmjs.com/package/react-linked-input</a></p>

<h2>New helpful warnings</h2>

<ul>
<li>developmentビルド(<code>NODE_ENV</code>が<code>production</code>でない)にも関わらずminifiedされている場合はproductionビルドを使うようにwarningが出ます。

<ul>
<li>Reactの中のコードを見たことがある人であればproductionビルドにする必要性がわかるはず&hellip;。developmentビルドには大量のデバッグやwarning用のコードが含まれています。</li>
</ul>
</li>
<li>styleのwidthやmarginに数値を渡すと自動で単位(px)を付与してくれますが、その際に数値を文字列として渡しているとwarningが出ます。将来のバージョンでは文字列の場合は単位が自動で付与されなくなります。

<ul>
<li><code>&lt;div style={ {width: 10} }&gt;</code>はOK、<code>&lt;div style={ {width: "10"} }&gt;</code>はwarningが出ます。</li>
</ul>
</li>
<li>SyntheticEventに追加でpropertyをセットしようとしたり、すでに解放されているのにアクセスしようとするとwarningが出力されます。

<ul>
<li>追加でpropertyをセットした場合にwarningが出るのはES2015のProxiesがサポートされている環境のみです。ちなみに自分が実装しました。</li>
</ul>
</li>
<li>ReactElementの<code>ref</code>と<code>key</code>のPropにアクセスしようとするとwarningが出力されます。これらはReact自体が使うためのPropでkeyで使った値が必要な場合は別途Propとして設定する必要があります。</li>
<li>DOM ElementのPropに対して、<code>onClick</code>を<code>onclick</code>のように大文字・小文字の指定が間違っている場合にはwarningが出力されるようになりました。</li>
</ul>


<h2>Notable bug fixes</h2>

<ul>
<li>幾つかのメモリリークが修正されています。</li>
</ul>


<hr />

<p>SyntheticEventでのメモリリークについては自分が修正したので紹介しておくとSyntheticEventの<code>target</code>属性が正しく解放されるようになりました。</p>

<p>SyntheticEventはPoolingされており、イベントハンドラーの処理が終了すると初期化されPoolに戻るのですが一番よく使う<code>target</code>属性だけ解放されていませんでした。
したがって、下記のようなコードはv0.14では動作していましたがv15では動作しません。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">Component</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">));</span> <span class="c1">// &lt;div&gt;click&lt;/div&gt;</span>
</span><span class='line'>    <span class="p">}}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="nx">click</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>これは<code>onClick</code>が実行された時点でSyntheticEvent(<code>e</code>)が初期化されており、setTimeoutのコールバック実行時にはすでにtargetの値が初期化(null)されているためです。
上記の場合、<code>target</code>をローカル変数として保持するか<code>e.persist()</code>を使って保持する必要があります。</p>

<p>SyntheticEventがPoolingされているのは大量のイベントオブジェクトを作成することで発生するGCを避けるなどパフォーマンス上の理由からなのですが、モダンなブラウザーではもう必要ないのではないかということでPoolingをやめることが検討されています。</p>

<p>SyntheticEvent周りは自分が追加したProxyを使ったコードなどかなり混沌としてきているのでPoolingやめてリファクタリングするのはとてもいいと思います。やりたい&hellip;。</p>

<p><a href="https://github.com/facebook/react/issues/6190">https://github.com/facebook/react/issues/6190</a></p>

<hr />

<ul>
<li>Mobile SafariやIE10, 11などでのイベントの扱いが改善されています。</li>
<li><code>cite</code>と<code>profile</code>の属性がサポートされました。</li>
<li><code>onAnimationStart</code>, <code>onAnimationEnd</code>, <code>onAnimationIteration</code>, <code>onTransitionEnd</code>, <code>onInvalid</code>のイベントがサポートされました。また<code>object</code>要素に<code>onLoad</code>イベントが追加されました。</li>
<li>ReactTransitionGroupで同時に複数要素を削除しようとした場合にも正しくハンドリングできるようになりました。</li>
<li>shallowCompareなどのいくつかの場所で<code>Object.is</code>による比較が行われるようになりました(実際にはpolyfill)。これにより、<code>+0 !== -0</code>となったり<code>NaN === NaN</code>となります。

<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is</a></li>
</ul>
</li>
<li><p>ReactDOMがデフォルトではpropertyとしてではなくattributeとして扱うようになります。これによるEdge caseなバグが修正されました。また属性値が<code>null</code>の場合に属性が完全に削除されるようになりました。これによりブラウザーがデフォルト値を設定しないようになります。</p></li>
<li><p>あとblogにはありませんでしたが、Stateless Componentsが<code>null</code>を返せるようになったのは地味に嬉しいですね！</p></li>
</ul>


<h2>Regression?</h2>

<ul>
<li>15.0.0-rc.1では<code>onTouchTap</code>が動作していないようなので使っている人は注意した方がよさそうです。

<ul>
<li><a href="https://github.com/facebook/react/issues/6221">https://github.com/facebook/react/issues/6221</a></li>
</ul>
</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[React.js meetup #3を開催しました]]></title>
    <link href="http://blog.koba04.com/post/2016/03/07/reactjs-meetup3/"/>
    <updated>2016-03-07T17:08:38+09:00</updated>
    <id>http://blog.koba04.com/post/2016/03/07/reactjs-meetup3</id>
    <content type="html"><![CDATA[<p>前回開催したのが9月だったみたいなので半年くらい経ちましたがReact.js meetup #3を開催しました。</p>

<ul>
<li><a href="http://reactjs-meetup.connpass.com/event/26229/">http://reactjs-meetup.connpass.com/event/26229/</a></li>
</ul>


<p>今回はサイボウズさんに会場を提供して頂き開催することができました。
サイボウズの皆様、参加者の皆様、発表者の皆様ありがとうございました！！</p>

<p>connpassの管理画面によると<strong>75/80人</strong>の方が参加してくださいました。感謝！</p>

<p><img src="http://blog.koba04.com/images/reactjs-meetup3.jpg" title="'React.js meetup #3'" ></p>

<!-- more -->


<h2>開催の経緯</h2>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/koba04">@koba04</a> hey! I&#39;ll be in Tokyo in February. Are there any ReactJS or general JavaScript meetups happening during that time?</p>&mdash; Christoph Pojer (@cpojer) <a href="https://twitter.com/cpojer/status/691698537306796032">January 25, 2016</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>というmentionがきっかけで急遽の開催となりました。前回と全く同じような経緯です。</p>

<p><a href="http://blog.koba04.com/post/2015/09/09/reactjs-meetup2/">http://blog.koba04.com/post/2015/09/09/reactjs-meetup2/</a></p>

<h2>準備など</h2>

<p><a href="https://twitter.com/yosuke_furukawa">@yusuke_furukawa</a>会長と相談しつつ、サイボウズさんに会場が決まってからは当日の準備や受付、懇親会の手配までサイボウズの方々にお任せしてしまって本当に助かりました！
というわけで今回も自分はあまり何もしてないのですがイベントの構成を考えたりしていました。</p>

<p>募集に関しては募集開始日に埋まることは予想していたのですが、2分持たずに埋まることまでは想定していなかったので次回の募集方法については考えようかなと思っています。
（先着・抽選50%ずつなど）</p>

<h2>Talk</h2>

<p>Talkに関しては、<a href="https://twitter.com/cpojer">@cpojer</a>さんのTalkは事前に相談して得意分野であるというjscodeshitについてのTalkをお願いしてReactなどについてはQ&amp;Aでという形になりました。
Q&amp;Aについては<a href="https://twitter.com/yando">@yando</a>さんが通訳してくださったので本当に助かりました。ありがとうございました！！</p>

<p>今回のTalkはJSConf EU 2015でのTalkがベースになっているので興味のある方はそちらも参照してください。</p>

<p><a href="https://www.youtube.com/watch?v=d0pOgY8__JM">https://www.youtube.com/watch?v=d0pOgY8__JM</a></p>

<p>その他のTalkについても自分が聞きたいなぁと思った内容について個別にTalkをお願いしました。
どのTalkも15分では短いくらいで面白かったです。</p>

<p>LTもどれも面白かったですね。</p>

<p>全部のTalkの資料が公開されているわけではないですが、下記のブログやtogetterによるまとめを見てください！</p>

<ul>
<li><a href="http://blog.cybozu.io/entry/2016/03/04/080000">http://blog.cybozu.io/entry/2016/03/04/080000</a></li>
<li><a href="http://togetter.com/li/942145">http://togetter.com/li/942145</a></li>
</ul>


<h2>参加者</h2>

<p>挙手でアンケートを取ったのですが、</p>

<ul>
<li>Reactを使っている人 &hellip; ほとんど全員</li>
<li>仕事でReact使っているという人 &hellip; 半分くらい</li>
<li>Redux使っている人 &hellip; 半分くらい</li>
<li>Facebook Flux使っている人 &hellip; 1割くらい</li>
<li>GraphQL、Relay使っている人 &hellip; 1人？</li>
<li>ReactNative使っている人 &hellip; 1人？</li>
</ul>


<p>みたいな感じでした。
GraphQL、Relay、ReactNativeなんかは英語の記事ではそこそこ見るのですがやはり導入のハードルが高いので実際に踏み込んでいる人はそんなに多くなさそうです。</p>

<p>ReactNativeはGitHubを見てる限り今も活発にメンテナンスされていて、React.js Conf 2016でもTalkが多かったので今後どうなるのかは注目しています。</p>

<h2>次回&hellip;?</h2>

<p>次回はなんとなく6月の頭にあるReact Europe後くらいがいいかなと思っていますが、何か話したいネタがあったり聞きたいテーマなどあれば教えてもらえるとそれまでに開催するかもしれないのでよろしくお願いします！</p>

<p>Reactの勉強会が少ない気がするという声も聞いたのでやりたい人がいたら是非やるといいんじゃないかなと思います！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[React.js v0.14 changes]]></title>
    <link href="http://blog.koba04.com/post/2015/09/22/react-js-v014-changes/"/>
    <updated>2015-09-22T00:00:00+09:00</updated>
    <id>http://blog.koba04.com/post/2015/09/22/react-js-v014-changes</id>
    <content type="html"><![CDATA[<p>React v0.14のRC版が出たので紹介したいと思います。
<a href="http://facebook.github.io/react/blog/2015/09/10/react-v0.14-rc1.html">http://facebook.github.io/react/blog/2015/09/10/react-v0.14-rc1.html</a></p>

<p>インストールはnpmからバージョン指定でインストールするかscriptを読み込むことで試すことが出来ます。
<code>react-dom</code>が何なのかは後ほど説明します。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install react@0.14.0-rc1
</span><span class='line'>npm install react-dom@0.14.0-rc1</span></code></pre></td></tr></table></div></figure>


<p>or</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://fb.me/react-0.14.0-rc1.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="c">&lt;!--  https://fb.me/react-with-addons-0.14.0-rc1.js --&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://fb.me/react-dom-0.14.0-rc1.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>Major changes</h2>

<h3>ReactとReactDOMのパッケージが分割されました</h3>

<p><code>react-native</code>や<code>react-canvas</code>など、DOM以外の環境で使われるようになってくる中で、Reactのコアの部分とDOMに関わる部分がパッケージとして分割されるようになりました。</p>

<p>Reactのパッケージには、<code>React.createElement</code>、<code>React.createClass</code>、<code>React.Component</code>、<code>React.PropTypes</code>、<code>React.Children</code>が含まれています。</p>

<p>ReactDOMのパッケージには、<code>ReactDOM.render</code>、<code>ReactDOM.unmountComponentAtNode</code>、<code>ReactDOM.findDOMNod</code>が含まれています。
また、ReactDOMのパッケージには<code>react-dom/server</code>として<code>ReactDOMServer.renderToString</code>と<code>ReactDOMServer.renderToStaticMarkup</code>が含まれています。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">[</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// サーバーサイド</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">ReactDOMServer</span> <span class="nx">from</span> <span class="s1">&#39;react-dom/server&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">html</span>  <span class="o">=</span> <span class="nx">ReactDOMServer</span><span class="p">.</span><span class="nx">renderToString</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>scriptタグで読み込んで利用する場合は、ReactとReactDOMそれぞれを読み込んで利用する必要があります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://fb.me/react-0.14.0-rc1.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://fb.me/react-dom-0.14.0-rc1.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;app&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;script&gt;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">App</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">App</span><span class="p">),</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>codemodも提供されているので既存のコードを一括で変換したい場合は使ってみるといいかもしれません。
<a href="https://github.com/facebook/react/blob/master/packages/react-codemod/README.md">https://github.com/facebook/react/blob/master/packages/react-codemod/README.md</a></p>

<h4>Addons</h4>

<p>また、Addonもそれぞれ個別のパッケージに分割されたので必要に応じてnpmでインストールするようになりました。</p>

<ul>
<li>react-addons-clone-with-props</li>
<li>react-addons-create-fragment</li>
<li>react-addons-css-transition-group</li>
<li>react-addons-linked-state-mixin</li>
<li>react-addons-perf</li>
<li>react-addons-pure-render-mixin</li>
<li>react-addons-shallow-compare</li>
<li>react-addons-test-utils</li>
<li>react-addons-transition-group</li>
<li>react-addons-update</li>
</ul>


<p>これによって、1つのAddonを使いたい時にその他全部のAddonがbundleされることがなくなりました。
scriptタグで読み込むための<code>react-with-addons</code>のJSにはこれまで通り全てのAddonが含まれています。</p>

<p>また、<code>batched_updates</code>としてあったReactのイベントやライフサイクル以外でもバッチによる一括アップデートを行えるAddonは<code>ReactDOM.unstable_batchedUpdates</code>に移動しました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="nx">cost</span> <span class="nx">component</span> <span class="o">=</span> <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">unstable_batchedUpdates</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">component</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span> <span class="o">++</span><span class="nx">count</span><span class="p">});</span>
</span><span class='line'>  <span class="nx">component</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span><span class="o">:</span> <span class="o">++</span><span class="nx">count</span><span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>ちなみにunstable_batchedUpdatesという名前になっているけど今後どうする予定なのかを聞いたところ、全ての更新をバッチ更新にしたいということだったので最終的には不必要にしたいようです。</p>

<p><strong>ReactとReactDOMやAddon</strong> のパッケージは意図しない挙動を避けるために同じバージョンを使うことが推奨されています。</p>

<h3>DOMComponentに対するrefによる参照でDOM Nodeが取得出来るようになりました</h3>

<p>これまでDOM nodeを取得したい場合には<code>React.findDOMNode(this.refs.div)</code> のようにする必要がありましたが、<code>this.refs.div</code>で直接DOM nodeを取得することが出来るようになりました。
findDOMNodeの呼び出しを書かなくてもいいというだけですが簡単になりました。
それと同時にrefでのComponentの参照はなるべくDOM Component以外では使わないようにしておかないと混乱を招きそうではあります。</p>

<p>また、<code>ReactDOM.render(&lt;div&gt;foo&lt;/div&gt;)</code> とした場合の返り値もDOM Nodeになります。
ReactDOM.findDOMNodeは以降もComposite Componentに対するDOM nodeを取得する場合に利用することが出来ます。</p>

<h3>Stateless Components</h3>

<p>Propsだけに依存するような状態を持たないComponentを定義するための新しい方法が追加されました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">Hello</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Arrow Functions</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">Hello</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Arror Functions and Destructuring Assignment</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">Hello</span> <span class="o">=</span> <span class="p">({</span><span class="nx">name</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>また、PropTypesやdefaultPropsも定義することが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">Hello</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">Hello</span><span class="p">.</span><span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">name</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="nx">Hello</span><span class="p">.</span><span class="nx">defaultProps</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;World&#39;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>あとContextも。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">Hello</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">context</span><span class="p">.</span><span class="nx">version</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">Hello</span><span class="p">.</span><span class="nx">contextTypes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">version</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>v0.14では最低限の実装のみになっていますが、以降のバージョンではStateless Componentsで書いておくことでパフォーマンス最適化の恩恵が受けられるようになる予定です。
v0.14以降ではStateless ComponentsがComponent定義の第一の選択肢になっていきそうです。</p>

<h3>react-toolsは廃止されました</h3>

<p>これは以前にもブログで紹介されていましたが、<code>react-tools</code>は非推奨になります(もう更新されない)。代わりにBabelを利用しましょう。</p>

<p><a href="http://facebook.github.io/react/blog/2015/06/12/deprecating-jstransform-and-react-tools.html">http://facebook.github.io/react/blog/2015/06/12/deprecating-jstransform-and-react-tools.html</a></p>

<ul>
<li>jsxコマンドは<code>babel</code>コマンドになります。</li>
<li>browserifyのtransformであるreactifyは<code>babelify</code>になります。</li>
<li>webpackのjsx-loaderは<code>babel-loader</code>になります</li>
<li>Node.jsのサーバー上で動かすときに<code>require('node-jsx').install()</code>としていたものは<code>require('babel/register')</code>になります。</li>
<li>ブラウザでJSXを変換するために使うJSXTransformはbabel-core/browser.jsを読み込んでtypeを<code>text/babel</code>にして使用します。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://fb.me/react-0.14.0-rc1.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://fb.me/react-dom-0.14.0-rc1.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;node_modules/babel-core/browser.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/babel&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">Hello</span> <span class="o">=</span> <span class="p">({</span><span class="nx">name</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>ちなみにBabelは6.0でTransformが全て外出しになり使う場合はpluginとして読み込みようになることが予定されています。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>&quot;plugins&quot;: [&quot;preset-es2015&quot;, &quot;preset-react&quot;]
</span></code></pre></td></tr></table></div></figure>


<h3>Babelによるコンパイル最適化が実施されるようになりました</h3>

<p>Babel5.8.23以降のバージョンを利用することで、<code>inlineElements</code>と<code>constantElements</code>を２つの最適化を行うことが出来るようになります。
これらは開発用のwarningやPropTypesによるチェックを無効化するので、productionモードの場合だけで有効にすることが推奨されています。</p>

<p>下記のコードを元に変換内容を確認してみます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// hello.js</span>
</span><span class='line'><span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>最適化なし</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">_React$Component</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">_inherits</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="nx">_React$Component</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">_classCallCheck</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">App</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">_get</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">App</span><span class="p">.</span><span class="nx">prototype</span><span class="p">),</span> <span class="s2">&quot;constructor&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">).</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">_createClass</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="p">[{</span>
</span><span class='line'>    <span class="nx">key</span><span class="o">:</span> <span class="s2">&quot;render&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
</span><span class='line'>        <span class="s2">&quot;div&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
</span><span class='line'>          <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="s2">&quot;Hello&quot;</span>
</span><span class='line'>        <span class="p">),</span>
</span><span class='line'>        <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
</span><span class='line'>          <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span>
</span><span class='line'>        <span class="p">)</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}]);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">App</span><span class="p">;</span>
</span><span class='line'><span class="p">})(</span><span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h4>inlineElements</h4>

<p>inlineElementsの最適化を行うことでJSXの変換が<code>React.createElement</code>への変換ではなくてただのオブジェクトへの変換となります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">babel</span> <span class="o">--</span><span class="nx">optional</span> <span class="nx">optimisation</span><span class="p">.</span><span class="nx">react</span><span class="p">.</span><span class="nx">inlineElements</span> <span class="nx">test</span><span class="p">.</span><span class="nx">js</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">_createClass</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="p">[{</span>
</span><span class='line'>  <span class="nx">key</span><span class="o">:</span> <span class="s2">&quot;render&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$$typeof</span><span class="o">:</span> <span class="nx">_typeofReactElement</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">key</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">ref</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">props</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">children</span><span class="o">:</span> <span class="p">[{</span>
</span><span class='line'>          <span class="nx">$$typeof</span><span class="o">:</span> <span class="nx">_typeofReactElement</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">key</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">ref</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">props</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">children</span><span class="o">:</span> <span class="s2">&quot;Hello&quot;</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="nx">_owner</span><span class="o">:</span> <span class="kc">null</span>
</span><span class='line'>        <span class="p">},</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">$$typeof</span><span class="o">:</span> <span class="nx">_typeofReactElement</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">key</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">ref</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">props</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">children</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="nx">_owner</span><span class="o">:</span> <span class="kc">null</span>
</span><span class='line'>        <span class="p">}]</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">_owner</span><span class="o">:</span> <span class="kc">null</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}]);</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="nx">App</span><span class="p">;</span>
</span><span class='line'><span class="p">})(</span><span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h4>constantElements</h4>

<p><code>constantElements</code>では、変数の含まれていないReactElementに対する呼び出しを<code>render</code>の外に出すことで不必要な<code>React.createElement</code>の呼び出しを避ける事が出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">babel</span> <span class="o">--</span><span class="nx">optional</span> <span class="nx">optimisation</span><span class="p">.</span><span class="nx">react</span><span class="p">.</span><span class="nx">constantElements</span> <span class="nx">test</span><span class="p">.</span><span class="nx">js</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">_ref</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
</span><span class='line'>  <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>  <span class="s2">&quot;Hello&quot;</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">_React$Component</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">_inherits</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="nx">_React$Component</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">_classCallCheck</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">App</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">_get</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">App</span><span class="p">.</span><span class="nx">prototype</span><span class="p">),</span> <span class="s2">&quot;constructor&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">).</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">_createClass</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="p">[{</span>
</span><span class='line'>    <span class="nx">key</span><span class="o">:</span> <span class="s2">&quot;render&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
</span><span class='line'>        <span class="s2">&quot;div&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">_ref</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span>
</span><span class='line'>          <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="kc">null</span><span class="p">,</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span>
</span><span class='line'>        <span class="p">)</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}]);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">App</span><span class="p">;</span>
</span><span class='line'><span class="p">})(</span><span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Breaking changes</h2>

<p>ここでのBreaking changeはv0.13でwarningとして出力されていたものです。</p>

<ul>
<li>Propsは変更不可として扱われます。開発用のビルドでは<code>Object.freeze</code>されています。Propsの値を変更したい場合は、<code>React.cloneElement</code>によって再生成する必要があります。</li>
<li>childrenにオブジェクト形式で渡すことはサポートされなくなりました。配列に変更するか<code>react-addons-create-fragment</code>を使う必要があります。</li>
<li><code>classSet</code>は削除されたので代わりに<code>classnames</code>のnpm packageを利用してください。</li>
</ul>


<hr />

<p>以下はv0.13でwarningが出力されていなかったものですが、簡単に修正することが出来る変更点です。</p>

<ul>
<li><code>React.initializeTouchEvents</code>は不要になったので削除してください。タッチイベントはデフォルトでサポートされるようになりました。</li>
<li>前述したDOM Componentに対するrefの変更により、<code>TestUtils.findAllInRenderedTree</code>とそれに関連するhelperはComposite Componentのみを受け取るようになりました。(<code>scryRendered〜</code>、<code>findRendered〜</code>系のTestUtils)</li>
</ul>


<h2>Deprecations</h2>

<ul>
<li><code>getDOMNode</code>は非推奨になったので代わりに<code>ReactDOM.findDOMNode</code>を利用してください。前述したとおりDOM Componentの場合は<code>ReactDOM.findDOMNode</code>も不要です。</li>
<li><code>setProps</code>と<code>replaceProps</code>は非推奨になります。代わりに親のComponentから再度<code>ReactDOM.render</code>を呼んでください。</li>
<li>ES6 ClassesによるComponent定義で<code>React.Component</code>を継承することが必須になりました。<a href="http://facebook.github.io/react/blog/2015/01/27/react-v0.13.0-beta-1.html#other-languages">ES3 module pattern</a>はまだ使用することが出来ます。</li>
<li><code>style</code>のPropsを別のrenderと共有し変更することはPropsが変更不可として扱われる影響で非推奨となりました。</li>
<li><code>react-addons-clone-with-props</code>は非推奨になりました。代わりに<code>React.cloneElement</code>を使用してください。<code>cloneElement</code>は<code>cloneWithProps</code>と違い、<code>className</code>と<code>style</code>のmergeは行いません。必要であれば開発者がmergeする必要があります。</li>
<li>信頼性向上のために<code>react-addons-css-transition-group</code>がtransition eventをlistenしなくなりました。そのため<code>transitionEnterTimeout={500}</code>のように明示的にdurationをPropsに指定する必要があります。</li>
</ul>


<h2>Enhancements</h2>

<ul>
<li><code>React.Children.toArray</code>が追加されました。ネストしたchildrenを受け取りkeyを設定したフラットな配列として返すことが出来ます。また<code>React.Children.map</code>もただの配列を返すようになりました。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">React</span><span class="p">.</span><span class="nx">Children</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span>
</span><span class='line'>  <span class="p">[</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">foo</span><span class="o">&lt;</span><span class="err">/div&gt;, &lt;div&gt;bar&lt;/div&gt;,</span>
</span><span class='line'>    <span class="p">[</span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">baz</span><span class="o">&lt;</span><span class="err">/div&gt;]</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// [&lt;div key=&quot;.0&quot;&gt;foo&lt;/div&gt;, &lt;div key=&quot;.1&quot;&gt;bar&lt;/div&gt;, &lt;div key=&quot;.2:0&quot;&gt;baz&lt;/div&gt;]</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p><code>console.warn</code>の代わりに<code>console.error</code>でwarningを出力するようになりました(stack traceを出すため)。<code>console.error</code>として出力されるwarningは将来のバージョンで壊れるような使い方をしていた場合であり、<code>must-fix</code>なエラーとして扱われるべきです。</p></li>
<li><p>可能であればReactDOMがXHTML互換なHTMLを生成するようになりました。</p></li>
<li><p>ReactDOMが<code>capture、challenge、inputMode、is、keyParams、keyType、minLength、summary、wrap</code>といった標準の属性や<code>autoSave、results、security</code>といった非標準な属性をサポートするようになりました。</p></li>
<li><p>SVG属性のサポートが追加されました。</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">xlinkActuate</span><span class="err">、</span><span class="nx">xlinkArcrole</span><span class="err">、</span><span class="nx">xlinkHref</span><span class="err">、</span><span class="nx">xlinkRole</span><span class="err">、</span><span class="nx">xlinkShow</span><span class="err">、</span><span class="nx">xlinkTitle</span><span class="err">、</span><span class="nx">xlinkType</span><span class="err">、</span><span class="nx">xmlBase</span><span class="err">、</span><span class="nx">xmlLang</span><span class="err">、</span><span class="nx">xmlSpace</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p><code>image</code>のSVGタグがサポートされました。</p></li>
<li><p>custome elementsで任意の属性がサポートされるようになりました。</p></li>
<li><p><code>audio</code>と<code>video</code>タグに対するイベントのサポートが追加されました。</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">onAbort</span><span class="err">、</span><span class="nx">onCanPlay</span><span class="err">、</span><span class="nx">onCanPlayThrough</span><span class="err">、</span><span class="nx">onDurationChange</span><span class="err">、</span><span class="nx">onEmptied</span><span class="err">、</span><span class="nx">onEncrypted</span><span class="err">、</span><span class="nx">onEnded</span><span class="err">、</span><span class="nx">onError</span>
</span><span class='line'><span class="nx">onLoadedData</span><span class="err">、</span><span class="nx">onLoadedMetadata</span><span class="err">、</span><span class="nx">onLoadStart</span><span class="err">、</span><span class="nx">onPause</span><span class="err">、</span><span class="nx">onPlay</span><span class="err">、</span><span class="nx">onPlaying</span>
</span><span class='line'><span class="nx">onProgress</span><span class="err">、</span><span class="nx">onRateChange</span><span class="err">、</span><span class="nx">onSeeked</span><span class="err">、</span><span class="nx">onSeeking</span><span class="err">、</span><span class="nx">onStalled</span><span class="err">、</span><span class="nx">onSuspend</span><span class="err">、</span><span class="nx">onTimeUpdate</span><span class="err">、</span><span class="nx">onVolumeChange</span><span class="err">、</span><span class="nx">onWaiting</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p><code>shallowCompare</code>のAddonがES6 ClassesのComponentで<code>PureRenderMixn</code>を使うためのマイグレーションのパスとして用意されました。</p></li>
<li><p><code>CSSTransitionGroup</code>が<code>xxx-enter-active</code>のようにclassNameに追加する名前を任意に指定出来るようになりました。</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="o">&lt;</span><span class="nx">ReactCSSTransitionGroup</span>
</span><span class='line'>   <span class="nx">transitionName</span><span class="o">=</span><span class="p">{</span>
</span><span class='line'>     <span class="nx">enter</span><span class="o">:</span> <span class="s1">&#39;enter&#39;</span><span class="p">,</span>
</span><span class='line'>     <span class="nx">enterActive</span><span class="o">:</span> <span class="s1">&#39;enterActive&#39;</span><span class="p">,</span>
</span><span class='line'>     <span class="nx">leave</span><span class="o">:</span> <span class="s1">&#39;leave&#39;</span><span class="p">,</span>
</span><span class='line'>     <span class="nx">leaveActive</span><span class="o">:</span> <span class="s1">&#39;leaveActive&#39;</span><span class="p">,</span>
</span><span class='line'>     <span class="nx">appear</span><span class="o">:</span> <span class="s1">&#39;appear&#39;</span><span class="p">,</span>
</span><span class='line'>     <span class="nx">appearActive</span><span class="o">:</span> <span class="s1">&#39;appearActive&#39;</span>
</span><span class='line'>   <span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="p">{</span><span class="nx">item</span><span class="p">}</span>
</span><span class='line'> <span class="o">&lt;</span><span class="err">/ReactCSSTransitionGroup&gt;</span>
</span><span class='line'>
</span><span class='line'> <span class="o">&lt;</span><span class="nx">ReactCSSTransitionGroup</span>
</span><span class='line'>   <span class="nx">transitionName</span><span class="o">=</span><span class="p">{</span>
</span><span class='line'>     <span class="nx">enter</span><span class="o">:</span> <span class="s1">&#39;enter&#39;</span><span class="p">,</span>
</span><span class='line'>     <span class="nx">leave</span><span class="o">:</span> <span class="s1">&#39;leave&#39;</span><span class="p">,</span>
</span><span class='line'>     <span class="nx">appear</span><span class="o">:</span> <span class="s1">&#39;appear&#39;</span>
</span><span class='line'>   <span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="p">{</span><span class="nx">item2</span><span class="p">}</span>
</span><span class='line'> <span class="o">&lt;</span><span class="err">/ReactCSSTransitionGroup&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Helpful warnings</h2>

<ul>
<li><p>ReactDOMがHTML構造と不正な要素を受け取った時点でwarningを出力するようになり、更新時に突然エラーとして表面化するよりわかりやすくなりました。</p></li>
<li><p><code>document.body</code>に対して<code>ReactDOM.render</code>使用するとwarningを出力するようになりました。</p></li>
<li><p>複数の異なるReactのオブジェクトを同時に利用しようとした場合に、warningを出力するようになりました。これはnpmとbrowserifyなどを組み合わせている場合に意図せずに起こってしまうことがあります。</p></li>
</ul>


<h2>Bug fixes</h2>

<ul>
<li><p>Mobile Browsersにおいてのクリックイベントのハンドリング(cursor: pointer周り？)にあったバグが修正されました。(特にMobile Safari)</p></li>
<li><p>SVG Elementが多くの場合で正しい名前空間と一緒に描画されるようになりました。</p></li>
<li><p>ReactDOMで複数のchildrenを持ったoptionの場合(<code>&lt;select&gt;&lt;option value={val}&gt;{label}:{val}&lt;/option&gt;&lt;/select&gt;</code>)にエラーとなっていたバグが修正されました。</p></li>
<li><p>サーバーサイドレンダリング時にselectタグのvalueがoptionタグのselectedとして反映されるようになりました。</p></li>
<li><p>同じdocumentに対して複数のReactのオブジェクトで要素を追加した状態になった時、イベントハンドリングのタイミングで発生していたエラーがなるべく起きないようになりました。但し、radio buttonを同じnameでrenderしていた場合などエラーになる状況は残っています。</p></li>
<li><p>小文字でないHTMLタグ名をReactDOMで使った場合でも問題にならないようになりました。ただしDOM Componentの場合には小文字で指定することを変わらずに推奨します。</p></li>
<li><p>ReactDOMが<code>animationIterationCount</code>、<code>boxOrdinalGroup</code>、<code>flexOrder</code>、<code>tabSize</code>、<code>stopOpacity</code>のCSSプロパティに対して&#8217;px&#8217;を追加しないようになりました。</p></li>
<li><p><code>react-addons-test-utils</code>で<code>Simulate.mouseEnter</code>と<code>Simulate.mouseLeave</code>が利用可能になりました。</p></li>
<li><p><code>react-addons-transition-group</code>で複数のnodeが同時に削除された場合にも正しく処理出来るようになりました。</p></li>
</ul>


<h2>ReactElement tags by Symbol</h2>

<p><a href="https://github.com/facebook/react/pull/4832">https://github.com/facebook/react/pull/4832</a></p>

<p>Reactではv0.14から<code>React.createElement</code>でReactElementのインスタンスではなくてただのオブジェクトが返ってくるようになっていたり、上の方で紹介したBabelによるinlineElementsの最適化によってcreateElementの呼び出しがただのオブジェクトに変換されることからも分かる通り、オブジェクトをそのままVIRTUAL DOMとして扱いDOMを生成することが出来ます。
そのためユーザーによって作成されるオブジェクトをそのままrenderに渡していると意図しないコンテンツを表示されたりXSSのリスクがあります。
(ユーザーが任意のオブジェクトをそのままReactElementとして描画出来ること自体が問題ではありますが)</p>

<ul>
<li><a href="https://github.com/facebook/react/issues/3473">How Much XSS Vulnerability Protection is React Responsible For? #3473</a></li>
</ul>


<p>そのため、信頼されたReactElementかどうかを判別するための方法が議論されていました。セキュリティに興味のある人はこの辺りのissueを見てみると面白いと思います。</p>

<ul>
<li><a href="https://github.com/facebook/react/pull/3583">[RFC] Trusted sources for React elements. #3583</a></li>
</ul>


<p>Reactでは最初はinstanceofでReactElementかどうかのチェックが行われていたのですが、それだと常にReactElementのインスタンスである必要がありオブジェクト化による最適化や複数のReactを使っていた場合にチェックが失敗するなど制限が多くなってしまいます。そのため、<code>_isReactElement</code>というがtrueかどうかをみるように変わりましたがこれでは信頼されたオブジェクトであるかを判定することは出来ません。</p>

<p>ユーザーが<code>_isReactElement</code>をオブジェクトに指定することでReactElementとして評価され、さらにReactには<code>dangerouslySetInnerHTML</code>というPropでHTMLをそのまま渡すことが出来るので&hellip;。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nx">type</span><span class="o">:</span><span class="s2">&quot;div&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">_isReactElement</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">props</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">dangerouslySetInnerHTML</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">__html</span><span class="o">:</span> <span class="s2">&quot;&lt;img onload=&#39;alert(123)&#39; src=&#39;/favicon.ico&#39; /&gt;&quot;</span><span class="p">.</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>v0.14ではSymbolを使って信頼されたReactElementかどうかを判定するようになります。</p>

<ul>
<li><a href="https://github.com/facebook/react/pull/4832">Use a Symbol to tag every ReactElement #4832</a></li>
</ul>


<h3>How it works?</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">TYPE_SYMBOL</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">Symbol</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">Symbol</span><span class="p">.</span><span class="k">for</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>                  <span class="nx">Symbol</span><span class="p">.</span><span class="k">for</span><span class="p">(</span><span class="s1">&#39;react.element&#39;</span><span class="p">))</span> <span class="o">||</span> <span class="mh">0xeac7</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/facebook/react/blob/d54fa9e563d968112f5461274dc4e9d2aa6ed35c/src/isomorphic/classic/element/ReactElement.js#L20-L22">https://github.com/facebook/react/blob/d54fa9e563d968112f5461274dc4e9d2aa6ed35c/src/isomorphic/classic/element/ReactElement.js#L20-L22</a></li>
</ul>


<p>上記のようにSymbolを保持していおいて、それを<code>React.createElement</code>で作成したObjectにも<code>$$typeof</code>というpropertyとして渡しておいて、ReactElementが有効であるかを返す<code>isValidElement</code>という関数の中の比較で利用しています。</p>

<p><code>Symbol.for</code>は指定されたSymbolがあればそれを返しなければ作成して返すので、グローバルなSymbolとして扱うことが出来ます。これによってただのオブジェクトも複数のReactを使っていた場合もサポートすることが出来ます。
(複数のReactがある場合は既に書いた通り別途warningが出ます)</p>

<p>Symbolが実装されていないような環境だと固定の値(0xeac7)になるので、この機能を有効にしたい場合はSymbolのpolyfillを入れておく必要があります。</p>

<p><a href="https://kangax.github.io/compat-table/es6/#Symbol">https://kangax.github.io/compat-table/es6/#Symbol</a></p>

<p>また、BabelのinlineElementsの最適化を使った場合にどうなるんだと思った人もいると思いますがすでに対応されて5.8.24としてリリースにされています。</p>

<p><a href="https://github.com/babel/babel/pull/2352">https://github.com/babel/babel/pull/2352</a></p>

<h2>v0.15?</h2>

<p>v0.15はGarbage collection releaseと位置づけられていて、つまりAPIの整理などに重点が置かれたリリースになる予定でv0.14のリリースから遠くないタイミングで出るそうです。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[React.js meetup #2を開催しました]]></title>
    <link href="http://blog.koba04.com/post/2015/09/09/reactjs-meetup2/"/>
    <updated>2015-09-09T22:53:58+09:00</updated>
    <id>http://blog.koba04.com/post/2015/09/09/reactjs-meetup2</id>
    <content type="html"><![CDATA[<ul>
<li><a href="http://reactjs-meetup.connpass.com/event/19504/">http://reactjs-meetup.connpass.com/event/19504/</a></li>
<li><a href="http://eventdots.jp/eventreport/568979">http://eventdots.jp/eventreport/568979</a></li>
</ul>


<p>4月に#1をやってから約4ヶ月くらい経ちましたがReact.js meetup #2を開催しました。</p>

<p>雨の中来てくださった方、発表者の方、運営のお手伝いをしてくださった方ありがとうございました！</p>

<!-- more -->


<h2>開催の経緯</h2>

<p>最初は今回発表してくださったViktorさんが来日されるのでそれにあわせてイベントをやるという話があり、せっかくなのでということでReact.js meetupの2回目としてやることになりました。</p>

<h2>dots</h2>

<p>開催予定日まで時間もなくてその時点で話す人も決まっていたので後は会場を決めればなんとかなりそうということで、いくつかの選択肢の中から今回はdotsさんで開催することになりました。
渋谷の駅から近くて、人数も200人近く入れるし会場もオシャレな感じだったのでここだ！という感じで決めました。</p>

<blockquote class="twitter-tweet" lang="en"><p lang="ja" dir="ltr"><a href="https://twitter.com/hashtag/reactjs_meetup?src=hash">#reactjs_meetup</a> #2 at dots!! (@ dots. in 渋谷区, 東京都) <a href="https://t.co/os56mGdfFu">https://t.co/os56mGdfFu</a> <a href="http://t.co/2BhpBeIK9H">pic.twitter.com/2BhpBeIK9H</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/641186091891073024">September 8, 2015</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>募集開始の際にはご迷惑をお掛けしましたが&hellip;dotsさん、ありがとうございました！</p>

<h2>準備など</h2>

<p>今回は <a href="https://twitter.com/yoshiko_pg">@yoshiko_pg</a> さんから話をもらって、その後の色々な準備もほとんどやってもらって本当に感謝でした。ありがとうございます！
当日の準備や受付は <a href="http://goodpatch.com/jp">Goodpatch</a> の方々がやってくださり、お菓子も提供して頂いて本当にありがたかったです。仲良さそうな感じが印象的でした。ありがとうございます！</p>

<h2>Talk</h2>

<p>各Talkのスライドはここにあるので見てください。</p>

<p><a href="http://reactjs-meetup.connpass.com/event/19504/">http://reactjs-meetup.connpass.com/event/19504/</a></p>

<p>自分のTalkはReactの次のバージョンである0.14での変更点について話しました。予想としてはRC版が出てるはずだったのですが&hellip;。
Stateless Componentsが加わったりはしていますが、基本的には無駄な機能は削ぎ落としたりメンテナンス性を維持していくための変更が多い印象で正しい方向に向かっている印象を持っています。</p>

<p>全体を通してReduxのような最近注目されているようなTopicから、Flowtypeのような型付けやDDDなどReact.jsやFluxを使って実際に大規模なアプリを作っていく中で求められるようなTopicについての話まであって面白かったです。</p>

<p>FlowtypeがもっとFacebook以外でも使いやすくコントリビュートしやすくなっていくといいなーと思いながら、それには壁がいくつもありそうだなとViktorさんと話して感じたり。</p>

<p>後、LTを一句で締めるのとてもよかったです。</p>

<h2>当日の様子</h2>

<p><a href="http://togetter.com/li/871189">http://togetter.com/li/871189</a></p>

<p>感想とか書いてもらえると嬉しいです！</p>

<h2>次回？</h2>

<p>まったく何も考えていないので、聞きたいテーマなどあれば教えてもらえると嬉しいです！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[YAPC::Asia Tokyo 2015で「今フロントエンドで何が起こっているのか」という話をしました]]></title>
    <link href="http://blog.koba04.com/post/2015/08/22/yapc-asia-2015-whats-happening-in-frontend-now/"/>
    <updated>2015-08-22T11:15:43+09:00</updated>
    <id>http://blog.koba04.com/post/2015/08/22/yapc-asia-2015-whats-happening-in-frontend-now</id>
    <content type="html"><![CDATA[<p>YAPC::Asia Tokyo 2015で「今フロントエンドで何が起こっているのか」という話をしました。</p>

<p><a href="http://yapcasia.org/2015/talk/show/94051590-fb11-11e4-a39d-8ab37d574c3a">http://yapcasia.org/2015/talk/show/94051590-fb11-11e4-a39d-8ab37d574c3a</a></p>

<!-- more -->


<p>満員になるほどたくさんの方に来て頂いてありがとうございました！</p>

<p>よくフロントエンドの話について聞かれると「Grunt or gulp」、「browserify or webpack」、「Angular or React」のような内容が多いので、新しいライブラリや仕様がそれぞれがどういった流れで登場し何を解決しようとしているのかを流れをもって紹介するような構成にしました。</p>

<p>jQuery以降というかなり広い範囲を対象にしたので、それを50minに収めるのために削ったトピックもかなりありますが&hellip;。</p>

<p>それでもASTなど普段ライブラリを使っているだけだとなかなか見えないけど重要な要素については残しました。</p>

<p>とりあげたトピックはこんな感じです。</p>

<ul>
<li>ES5</li>
<li>CoffeeScript</li>
<li>jQuery</li>
<li>Backbone</li>
<li>Node.js</li>
<li>Grunt</li>
<li>SinglePageApplication</li>
<li>TypeScript</li>
<li>AST</li>
<li>Isomorphic</li>
<li>Angular</li>
<li>gulp</li>
<li>browserify</li>
<li>ES2015</li>
<li>Babel・TC39</li>
<li>Service Workers</li>
<li>Extensible Web</li>
<li>React, Flux</li>
<li>FRP</li>
<li>Redux</li>
<li>Unix philosophy</li>
</ul>


<p>駆け足になったのでわかりにくい部分もあったと思いますが、少しでもその辺りが伝われば嬉しいです。</p>

<p><a href="https://speakerdeck.com/koba04/whats-happening-in-frontend-now">https://speakerdeck.com/koba04/whats-happening-in-frontend-now</a></p>

<script async class="speakerdeck-embed" data-id="4d78b0afe4fa4e078544e80db2eb8bd1" data-ratio="1.33333333333333" src="http://blog.koba04.com//speakerdeck.com/assets/embed.js"></script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[YAPC::Asia Tokyo 2015で「What's happening in frontend now?」という話をします]]></title>
    <link href="http://blog.koba04.com/post/2015/08/20/talk-at-yapc-asia2015/"/>
    <updated>2015-08-20T20:00:49+09:00</updated>
    <id>http://blog.koba04.com/post/2015/08/20/talk-at-yapc-asia2015</id>
    <content type="html"><![CDATA[<p><a href="http://yapcasia.org/2015/talk/show/94051590-fb11-11e4-a39d-8ab37d574c3a">http://yapcasia.org/2015/talk/show/94051590-fb11-11e4-a39d-8ab37d574c3a</a></p>

<p>無事にTalkを採択していただけたので、<strong>2015-08-21 13:10からトラックB (701-702）</strong> にて「What&rsquo;s happening in frontend now?」という話をします。</p>

<!-- more -->


<p>主にJavaScriptの話を中心に、Ajaxが登場した2005年くらいからどのようにフロントエンドを取り巻く技術が変わってきたのかを話したいと思います。
実際に書いてみると膨大な感じになってしまい50分で収まるように泣く泣く削ったトピックもかなりありますが、
jQueryからReactまでそのライブラリをどのように使うのかではなくどのような流れで登場し何を解決しようとしているのかを中心に話したいと思います。</p>

<p>フロントエンドを普段からバリバリ書いている人ではなく、たまにフロントエンドを触ろうと思っても次から次へと色々なライブラリや技術が登場してきてよくわからないという人に対して、今何が起きているのかを伝えることが出来ればと思っています。</p>

<p><img src="http://blog.koba04.com/images/yapc2015-slide.png" title="'YAPC Asia 2015 slide'" ></p>

<p>是非来てください！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[React.js meetup #1 を開催しました]]></title>
    <link href="http://blog.koba04.com/post/2015/04/25/reactjs-meetup1/"/>
    <updated>2015-04-25T17:11:35+09:00</updated>
    <id>http://blog.koba04.com/post/2015/04/25/reactjs-meetup1</id>
    <content type="html"><![CDATA[<p><a href="http://reactjs-meetup.connpass.com/event/11232/">http://reactjs-meetup.connpass.com/event/11232/</a></p>

<p>一人Advent Calendar書いた時にやりたいと言っていたのでReact.js meetup #1 を<a href="http://twitter.com/yosuke_furukawa">@yosuke_furukawa</a>さんと開催しました。</p>

<p> DeNAさんが会場から懇親会のお酒や寿司、当日の運営まで全てやってくださったので自分はほとんど何もしてないですが..。
 本当にありがとうございました！！</p>

<p>やりたいって言ってこの規模の勉強会を開催させてもらえるの本当にスゴいなぁと思います&hellip;。</p>

<p> <blockquote class="twitter-tweet" lang="en"><p><a href="https://twitter.com/hashtag/reactjs_meetup?src=hash">#reactjs_meetup</a> <a href="https://twitter.com/hashtag/react_sushi?src=hash">#react_sushi</a> です <a href="http://t.co/GdpyF7Paqk">pic.twitter.com/GdpyF7Paqk</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/591580062702383107">April 24, 2015</a></blockquote></p>

<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>




<!-- more -->


<p>ある程度予想はしていたのですが、Talkが10分と短かったりで押して慌ただしい感じになってしまったのは申し訳なかったなぁと思ってます。
ただ、色んなテーマのTalkを一度に聞くことが出来たのはよかったかなと思っています。</p>

<h2>Talks</h2>

<p>各Talkの資料についてはconpassのページに追加しておいたのでそちらを見て頂くとして簡単な一言感想です。</p>

<p><a href="http://reactjs-meetup.connpass.com/event/11232/presentation/">http://reactjs-meetup.connpass.com/event/11232/presentation/</a></p>

<h3><a href="https://twitter.com/naoya_ito">@naoya_ito</a> &ndash; React概論</h3>

<p>Reactの特徴をわかりやすく説明していてReact.js触ってない人にとってもわかりやすい説明だったんじゃないかなと思います。</p>

<h3><a href="https://twitter.com/hokaccha">@hokaccha</a> &ndash; react-rails</h3>

<p>Railsと一緒に使いたい人にとってはかなり有益な情報だったんじゃないかなと思います。Turbolinksどうするのとか。</p>

<h3><a href="https://twitter.com/azu_re">@azu_re</a> &ndash; 10分で実装するFlux</h3>

<p>Fluxを最小限の構成にしてデータの流れを一方向にするということがどういうことなのか説明していてわかりやすかったです。console.traceを使っての説明もなるほどなぁと思いました。</p>

<h3><a href="http://twitter.com/yosuke_furukawa">@yosuke_furukawa</a> &ndash; mercury/mithril.js</h3>

<p>React.jsのVIRTUAL DOMのdiffアルゴリズムの説明からmercuryやmithril.jsといった他のライブラリがどうやってReact.jsより高速化しているのかという説明で面白かったです。</p>

<h3><a href="https://twitter.com/mizchi">@mizchi</a> &ndash; React/FluxでSPAを開発してぶちあたった問題</h3>

<p>KobitoをReact.js + Fluxで作った時の問題になった点と解決方法について説明していて、ないものは作る姿勢がスゴイなぁ思いました。</p>

<h3><a href="https://twitter.com/sugyan">@sugyan</a> &ndash; React.jsと、 Railsとかアイドルとか (LT)</h3>

<p>React.jsとRailsでReactRouter使ったり色々組み合わてみた話でツラいと言いながらちゃんと作ってしまうところがスゴイなぁと思いました。</p>

<h3><a href="https://twitter.com/making">@making</a> &ndash; Java + React.jsでSever Side Rendering (LT)</h3>

<p>SPAで作ったブログが検索に引っかからないからReact.js + Javaでserver-side renderingするようにしたという話で、最後のオチも含めて面白かったです。</p>

<h3><a href="https://twitter.com/tyshgc">@tyshgc</a> &ndash; Rapid React Prototyping : React.jsでUIデザインプロトタイプを作る (LT)</h3>

<p>React.jsでプロトタイプを作る話で、Photoshopのレイヤー情報からReact.jsのComponentを生成するようにしていてスゴかったです。</p>

<h3><a href="https://twitter.com/teppeis">@teppeis</a> &ndash; Flowtype (LT)</h3>

<p>懇親会の時にFlowtypeについてのLTをしてくれて、デモもあったりFacebookが開発中のElectron(旧:AtomShell)ベースのNuclideの話まであって面白かったです。</p>

<h2>LiveCodingやった</h2>

<p>ぼっちでも懇親会に参加して欲しかったので、ぼーっと見ていたり会話のネタになるかなと思ってLiveCodeingをやってみました。</p>

<p>最近だとJSの環境を作るにも何を使えばいいのかわからないという声も聞くので、0から簡単なアプリを作るところまでの流れを伝えられればと思い、HackerNewsのAPIを使ってTopStoryの一覧を表示するものを作ってみました。</p>

<p>あと、3分間クッキングみたいに事前に色々用意しておくのもライブ感がないなぁと思ったので<code>mkdir</code>から全部その場で作ることにしました。</p>

<p><a href="https://github.com/koba04/react-hacker-news-stories/tree/meetup">https://github.com/koba04/react-hacker-news-stories/tree/meetup</a></p>

<p>環境構築は、browserifyとwatchifyとbabelifyで変換を行ってlivereloadするためのbrowser-syncを使いました。</p>

<p>LiveCodingの流れとしては</p>

<ul>
<li>ディレクトリ作ったり<code>npm init</code>したり<code>npm install</code>したりして環境を作る</li>
<li>Hello Worldしてみる(Hellって書いたけど&hellip;)</li>
<li>各Componentを作成する</li>
<li>HackerNewsのAPI叩いて一覧が出るようにする</li>
<li><code>React.addons.Perf</code>を使ってDOMが無駄に更新されていることとkeyが指定されていないwarningが出ていることを確認</li>
<li>keyを指定することで無駄のDOM操作がなくなることを確認</li>
<li>diffの時間を減らすために<code>Immutable.js</code>を使いつつ<code>shouldComponentUpdate</code>を実装</li>
</ul>


<p>という感じで行いました。</p>

<p>ライブコーディングが初めてで緊張していたのとお酒が入っていたのもあって(言い訳)、いつもと同じ感覚でコーディング出来なくてtypoしまくってしまい、「これ終わらないかも&hellip;」とかなり駆け足になってしまったのは反省です&hellip;。
(事前に練習はしたんですが&hellip;)</p>

<p>でも、とりあえず最後まで出来てよかった&hellip;。</p>

<h2>まとめ</h2>

<p>イベントの管理者側でやるのは初めてだったので色々至らない点があったかもしれませんが、準備してくださったDeNAの方々、発表者の方々、参加者の皆様、本当にありがとうございました！！</p>

<p>感想とかブログに書いてもらえると嬉しいです！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Setting up minimum single page application]]></title>
    <link href="http://blog.koba04.com/post/2015/03/19/setting-up-minimum-single-page-application/"/>
    <updated>2015-03-19T18:54:49+09:00</updated>
    <id>http://blog.koba04.com/post/2015/03/19/setting-up-minimum-single-page-application</id>
    <content type="html"><![CDATA[<p>React.jsなどを試そうとするときに、browserify? gulp? grunt? webpack? どれ使えばいいのとか、テストは何を使えばいいのかとかよくわからないというのをたまに聞くので、最低限の設定だけどES6で書けたりautobuildやlivereloadが出来る構成のサンプルを作ってみました。</p>

<p>あと、テストはkarma + mocha + power-assertでchromeでテスト出来るようにしています。</p>

<!-- more -->


<p>本当はpackage.jsonだけにしたかったのですがkarmaの設定だけは別ファイルになってます&hellip;。
テストが必要ない場合は、package.jsonの指定だけで大丈夫です。</p>

<ul>
<li><a href="https://github.com/koba04/minimum-spa-boilerplate">https://github.com/koba04/minimum-spa-boilerplate</a></li>
</ul>


<p>git cloneして<code>npm install</code>して<code>npm start</code>すればいいだけの設定になっています。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone git@github.com:koba04/minimum-spa-boilerplate.git
</span><span class='line'>npm install
</span><span class='line'>npm start</span></code></pre></td></tr></table></div></figure>


<p><img src="http://i.gyazo.com/f906464bfb325437c5c905f80a5b976d.gif" alt="gif" /></p>

<h2>概要</h2>

<h3>tree</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  tree -L 1
</span><span class='line'>.
</span><span class='line'>├── README.md
</span><span class='line'>├── index.js         // エントリーポイント
</span><span class='line'>├── karma.conf.js    // karmaの設定
</span><span class='line'>├── lib              // ソース
</span><span class='line'>├── node_modules
</span><span class='line'>├── package.json     // 設定はこの中
</span><span class='line'>├── public           // document root
</span><span class='line'>└── test             // テスト</span></code></pre></td></tr></table></div></figure>


<h3>package.json</h3>

<p>基本的には<code>npm init</code>で作ったものに色々インストールしてnpm scriptの設定をしているだけです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'>  <span class="s2">&quot;scripts&quot;</span><span class="err">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nt">&quot;build&quot;</span><span class="p">:</span> <span class="s2">&quot;NODE_ENV=production browserify index.js -t babelify | uglifyjs &gt; public/bundle.js&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;watch&quot;</span><span class="p">:</span> <span class="s2">&quot;watchify -d index.js -t babelify -o public/bundle.js -v&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;server&quot;</span><span class="p">:</span> <span class="s2">&quot;browser-sync start --server public --files public/**/*&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;karma start&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;npm run watch &amp; npm run server &amp; npm test&quot;</span>
</span><span class='line'>  <span class="p">}</span><span class="err">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="s2">&quot;dependencies&quot;</span><span class="err">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nt">&quot;react&quot;</span><span class="p">:</span> <span class="s2">&quot;^0.13.1&quot;</span>
</span><span class='line'>  <span class="p">}</span><span class="err">,</span>
</span><span class='line'>  <span class="s2">&quot;devDependencies&quot;</span><span class="err">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nt">&quot;babelify&quot;</span><span class="p">:</span> <span class="s2">&quot;^5.0.4&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;browser-sync&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.3.1&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;browserify&quot;</span><span class="p">:</span> <span class="s2">&quot;^9.0.3&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;espowerify&quot;</span><span class="p">:</span> <span class="s2">&quot;^0.10.0&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;karma&quot;</span><span class="p">:</span> <span class="s2">&quot;^0.12.31&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;karma-browserify&quot;</span><span class="p">:</span> <span class="s2">&quot;^4.0.0&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;karma-chrome-launcher&quot;</span><span class="p">:</span> <span class="s2">&quot;^0.1.7&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;karma-cli&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.4&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;karma-mocha&quot;</span><span class="p">:</span> <span class="s2">&quot;^0.1.10&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;mocha&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.2.1&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;power-assert&quot;</span><span class="p">:</span> <span class="s2">&quot;^0.10.2&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;uglify-js&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.4.17&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;watchify&quot;</span><span class="p">:</span> <span class="s2">&quot;^2.4.0&quot;</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="https://github.com/koba04/minimum-spa-boilerplate/blob/master/package.json">https://github.com/koba04/minimum-spa-boilerplate/blob/master/package.json</a></p>

<ul>
<li><code>npm run build</code></li>
</ul>


<p>これはReactに依存したビルドになっているのですが、production用にビルドされたファイルを生成することを想定しています。</p>

<ul>
<li><code>npm run watch</code></li>
</ul>


<p>watchifyによってファイルが変更されたら自動的にbrowserifyのビルドが走るようになっています。
watchifyはキャッシュするので二回目以降のビルドが高速化されるのもポイントです。</p>

<ul>
<li><code>npm run server</code></li>
</ul>


<p>BrowserSyncによって<code>public</code>をrootにしたserverを立ちあげつつ、<code>public</code>以下のファイルを監視してlivereloadするようになっています。</p>

<ul>
<li><code>npm test</code></li>
</ul>


<p>テストはkarmaを使うので<code>karma start</code>しているだけです。<code>karma</code>の設定は<code>karma.conf.js</code>にあります。</p>

<ul>
<li><code>npm start</code></li>
</ul>


<p>上記のweatchとbrowserとtestをまとめて実行するコマンドで、これだけ実行すれば開発を始められるようになっています。</p>

<h3>karma</h3>

<p>karmaは<code>karma init</code>で対話的に作成出来る<code>karma.conf.js</code>にbrowserifyの設定を追加したくらいです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// frameworks to use</span>
</span><span class='line'><span class="c1">// available frameworks: https://npmjs.org/browse/keyword/karma-adapter</span>
</span><span class='line'><span class="nx">frameworks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;mocha&#39;</span><span class="p">,</span> <span class="s1">&#39;browserify&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// list of files / patterns to load in the browser</span>
</span><span class='line'><span class="nx">files</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>  <span class="s1">&#39;test/**/*.js&#39;</span>
</span><span class='line'><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// list of files to exclude</span>
</span><span class='line'><span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">// preprocess matching files before serving them to the browser</span>
</span><span class='line'><span class="c1">// available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor</span>
</span><span class='line'><span class="nx">preprocessors</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="s1">&#39;test/**/*.js&#39;</span><span class="o">:</span> <span class="s1">&#39;browserify&#39;</span>
</span><span class='line'><span class="p">},</span>
</span><span class='line'>
</span><span class='line'><span class="nx">browserify</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">debug</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">transform</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>    <span class="s2">&quot;babelify&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;espowerify&quot;</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>karmaについては以前にも書いたのでそちらも。</p>

<ul>
<li><a href="http://blog.koba04.com/post/2014/06/23/karma-for-javascript-test-runner/">http://blog.koba04.com/post/2014/06/23/karma-for-javascript-test-runner/</a></li>
</ul>


<p>今回はカジュアルさを優先したので設定していませんが、travis-ciを使いたい場合は、<code>karma-phantomjs-launcher</code>を入れて<code>npm test</code>でPhantomJSで実行出来るようにすればOKだと思います。</p>

<h3>Code</h3>

<p>コードはこんな感じで書けます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="nx">World</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="https://github.com/koba04/minimum-spa-boilerplate/blob/master/lib/components/app.js">https://github.com/koba04/minimum-spa-boilerplate/blob/master/lib/components/app.js</a></p>

<h3>Test</h3>

<p>テストはこんな感じ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">import</span> <span class="nx">assert</span> <span class="nx">from</span> <span class="s1">&#39;power-assert&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react/addons&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;../../lib/components/app&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">const</span> <span class="p">{</span><span class="nx">TestUtils</span><span class="p">}</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">addons</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;App&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">let</span> <span class="nx">component</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">component</span> <span class="o">=</span> <span class="nx">TestUtils</span><span class="p">.</span><span class="nx">renderIntoDocument</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;returns Hello World in div&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nx">TestUtils</span><span class="p">.</span><span class="nx">findRenderedDOMComponentWithTag</span><span class="p">(</span><span class="nx">component</span><span class="p">,</span> <span class="s1">&#39;div&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">assert</span><span class="p">(</span>
</span><span class='line'>      <span class="nx">React</span><span class="p">.</span><span class="nx">findDOMNode</span><span class="p">(</span><span class="nx">div</span><span class="p">).</span><span class="nx">textContent</span>
</span><span class='line'>      <span class="o">===</span>
</span><span class='line'>      <span class="s1">&#39;Hello World&#39;</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>おまけ</h2>

<h3>karma-browserify + power-assert + babel</h3>

<p>npm scriptでbrowserifyとwatchifyの引数に<code>babelify</code>を指定していますが、本当は↓のようにbrowserifyのtransformフィールドにだけ指定してkarmaには<code>espowerify</code>だけを指定したいところなのですが、<code>karma-browserify</code>に指定するtransformはbrowserifyにoptionとしてそのまま渡されるのではなくて事前にtransformするので、<code>espowerify</code>が<code>babelify</code>される前のコードを対象としてしまいエラーになります&hellip;。</p>

<p>なのでここでは、それぞれに個別に設定する形になっています&hellip;。
レアケースですがなんとかしたいなぁと思いつつ&hellip;。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s2">&quot;browserify&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;transform&quot;</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>    <span class="p">[</span><span class="s2">&quot;babelify&quot;</span><span class="p">]</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<hr />

<p>そこそこカジュアルな感じになっているかなぁと思います。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[React.js v0.13 changes]]></title>
    <link href="http://blog.koba04.com/post/2015/03/05/react-js-v013-changes/"/>
    <updated>2015-03-05T09:23:28+09:00</updated>
    <id>http://blog.koba04.com/post/2015/03/05/react-js-v013-changes</id>
    <content type="html"><![CDATA[<p>React.js v0.13のRC2がリリースされたのでまとめてみます。</p>

<ul>
<li><a href="http://facebook.github.io/react/blog/2015/02/24/react-v0.13-rc1.html">http://facebook.github.io/react/blog/2015/02/24/react-v0.13-rc1.html</a></li>
<li><a href="http://facebook.github.io/react/blog/2015/03/03/react-v0.13-rc2.html">http://facebook.github.io/react/blog/2015/03/03/react-v0.13-rc2.html</a></li>
<li><a href="http://facebook.github.io/react/blog/2015/02/24/streamlining-react-elements.html">http://facebook.github.io/react/blog/2015/02/24/streamlining-react-elements.html</a></li>
</ul>


<p>今回のバージョンで何か大きく変更があるというよりもv0.14でやりたいことに向けての布石が多いように感じます。</p>

<p>試すときはこの辺りから。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install react@0.13.0-rc2 
</span><span class='line'>npm install react-tools@0.13.0-rc2 </span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://fb.me/react-0.13.0-rc2.js
</span><span class='line'>http://fb.me/react-0.13.0-rc2.min.js
</span><span class='line'>http://fb.me/react-with-addons-0.13.0-rc2.js
</span><span class='line'>http://fb.me/react-with-addons-0.13.0-rc2.min.js
</span><span class='line'>http://fb.me/JSXTransformer-0.13.0-rc2.js</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>Propを変更するとwarninngが出ます (Breaking Change)</h2>

<p>development環境でPropをelement作成後に変更することはdeprecatedになってwarningが出るようになりました。
つまりimmutableなものとして扱う必要があります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">element</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">Foo</span> <span class="nx">bar</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">shouldUseFoo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">element</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">element</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">bar</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>これまでの問題点</h3>

<ul>
<li>Propを直接変更してしまうと元の値を破棄してしまうのでdiffがなくなってしまいます。この場合、<code>shouldComponentUpdate</code>を実装している場合に比較時に差分を検出出来なくてDOM構造に差分があるはずなのに実際には反映されない可能性がありました。</li>
<li>またPropが変更されることがあるためcreateElementの時点でPropTypesのValidationも出来ず、それによってエラー時のstacktraceが深くなったりFlowによる静的解析にとっても都合がよくなかったりという面もありました。</li>
</ul>


<h4>それに対しての提案</h4>

<ul>
<li>動的にしたい場合は↓のような形で書くことでも可能です。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">shouldUseFoo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Foo</span> <span class="nx">foo</span><span class="o">=</span><span class="p">{</span><span class="mi">10</span><span class="p">}</span> <span class="nx">bar</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Foo</span> <span class="nx">bar</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">props</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">bar</span><span class="o">:</span> <span class="kc">false</span> <span class="p">};</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">shouldUseFoo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">props</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">props</span><span class="p">.</span><span class="nx">bar</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">return</span> <span class="o">&lt;</span><span class="nx">Foo</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>現時点ではネストしたオブジェクトについては変更してもwarningは出ません。基本的にはimmutable.jsなどを使って完全にimmutableに扱った方がいいですが、mutableなオブジェクトは多くの場面で便利だし今回はネストしたオブジェクトはwarningの対象外となりました。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">return</span> <span class="o">&lt;</span><span class="nx">Foo</span> <span class="nx">nestedObject</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">myModel</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>PropTypesのwarningをReactElementの作成時に行うなうようになりました。Propを変更するために↓のようにcloneしてReactElementにPropに値を追加するのは正しい方法です。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">element1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">Foo</span> <span class="o">/&gt;</span><span class="p">;</span> <span class="c1">// extra prop is optional</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">element2</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">addons</span><span class="p">.</span><span class="nx">cloneWithProps</span><span class="p">(</span><span class="nx">element1</span><span class="p">,</span> <span class="p">{</span> <span class="nx">extra</span><span class="o">:</span> <span class="s1">&#39;prop&#39;</span> <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>statics内のメソッドに対してautobindingされなくなりました (Breaking Change)</h2>

<p><code>statics</code>に定義したメソッドをonClickなどにバインドした時にcomponentをバインドしなくなりました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">Hello</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">statics</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">foo</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">bar</span><span class="p">();</span>  <span class="c1">// v0.13では呼べない</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">bar</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">hello</span> <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">foo</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">click</span><span class="o">&lt;</span><span class="err">/button&gt;&lt;/div&gt;;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>refを設定する処理の順番が変わりました (Breaking Change)</h2>

<p><code>ref</code>に指定されたcomponentの<code>componentDidMount</code>が呼ばれた後になります。
これは親componentのcallbackを<code>componentDidMount</code>の中で読んでいる場合だけ気にする必要があります。そもそれもこれはアンチパターンなので避けるべきですが&hellip;。</p>

<ul>
<li><code>componentDidMount</code>は子componentから順番に呼ばれるので下記の<code>refDiv</code>はChildの<code>componentDidMount</code>の時点では設定されていません。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">Hello</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">refDiv</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">Child</span> <span class="nx">foo</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">foo</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">ref</span><span class="o">=</span><span class="s2">&quot;refDiv&quot;</span><span class="o">&gt;</span><span class="nx">hello</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">Child</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">foo</span><span class="p">();</span> <span class="c1">// v0.13 &quot;undefined&quot;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">child</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2><code>this.setState()</code>が第1引数に関数を受け取れるようになりました</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">((</span><span class="nx">state</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span><span class="nx">count</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}));</span>
</span></code></pre></td></tr></table></div></figure>


<p>のようにすることで<code>this._pendingState</code>を使うことなくトランザクションが必要とされるstateの更新を行うことが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="c1">// 0</span>
</span><span class='line'><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">count</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">})</span>
</span><span class='line'><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">count</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">})</span>
</span><span class='line'><span class="c1">// state.count will render as 1</span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="c1">// 0</span>
</span><span class='line'><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">{</span> <span class="nx">count</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">});</span>
</span><span class='line'><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">{</span> <span class="nx">count</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">});</span>
</span><span class='line'><span class="c1">// state.count will render as 2</span>
</span></code></pre></td></tr></table></div></figure>


<h2>setStateの呼び出しが常に非同期になります (Breaking Change)</h2>

<p>ライフサイクルメソッドの中での<code>setState</code>の呼び出しが常に非同期でバッチとして処理されます。以前は最初のマウント時の呼び出しは同期的に行われていました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="c1">// 0</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">count</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">})</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">count</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">})</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="c1">// v0.13 is 0 (v0.12 is 2)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>setStateとforceUpdateをunmountされたcomponentに対して呼んだ時に、エラーではなくwarningが出るようになりました (Breaking Change)</h2>

<p>非同期処理の結果を<code>setState</code>して反映させるときに、<code>isMounted</code>でブロックしなくてもよくなったのはいいですね。</p>

<h2>privateなプロパティが整理されました (Breaking Change)</h2>

<p><code>this._pendingState</code>や<code>this._rootNodeID</code>などのprivateなプロパティが削除されました。</p>

<h2>ES6 classesによるReactComponentの作成がサポートされました</h2>

<p>これについては↓に書きましたが、ES6 classesによって作成されたcomponentには<code>createClass</code>にはある<code>getDOMNode</code>、<code>setProps</code>、<code>replaceState</code>が含まれていなかったりmixinが指定出来ないなど注意点がいくつかあります。</p>

<ul>
<li><a href="http://blog.koba04.com/post/2015/01/28/published-react-v0.13.0-beta1/">http://blog.koba04.com/post/2015/01/28/published-react-v0.13.0-beta1/</a></li>
</ul>


<h2><code>React.findDOMNode(component)</code>のAPIが追加されました</h2>

<p>これは既存の<code>component.getDOMNode()</code>を置き換えるAPIです。
<code>getDOMNode()</code>はES6 classesによって作成されたcomponentでは提供されていません。</p>

<h2><code>ref</code>がcallbackスタイルで指定できるようになりました。</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="o">&lt;</span><span class="nx">Photo</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_photo</span> <span class="o">=</span> <span class="nx">c</span><span class="p">}</span> <span class="o">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>この変更はこの後で書く<code>owner</code>の扱いの変更に関係しています。</p>

<h2>childrenにiteratorやimmutable-jsのsequenceを指定出来るようになりました</h2>

<p>immutable-jsを使っている人にとってはいいですね。</p>

<h2><code>ComponentClass.type</code>はdeprecatedになりました</h2>

<p>代わりに<code>ComponentClass</code>をそのまま使ってください。</p>

<h2>ownerベースのcontextを使っていてparentベースのcontextと一致しない場合にwarningが出るようになります</h2>

<p>そもそもowner? parent?という感じかと思うので簡単に説明します。</p>

<h3>owner and parent</h3>

<p>Reactは&#8221;parent&#8221;と&#8221;owner&#8221;を持っています。&#8221;owner&#8221;はReactElementを作ったcomponentです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">class</span> <span class="nx">Foo</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;&lt;</span><span class="nx">span</span> <span class="o">/&gt;&lt;</span><span class="err">/div&gt;;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>この場合、<code>span</code>のownerは<code>Foo</code>でparentは<code>div</code>になります。</p>

<h3>context</h3>

<p>これはdocument化されてないfeatureですが、&#8221;owner&#8221;から子や孫に渡すことが出来る&#8221;context&#8221;というものがあります。</p>

<p>簡単にコードを書くとこんな感じです。見てもらえればどんなfeatureなのかわかるかと思います。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">Parent</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">childContextTypes</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">name</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">age</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">getChildContext</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;parent&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">age</span><span class="o">:</span> <span class="mi">50</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Child</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">Child</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">contextTypes</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">name</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">age</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">componentDidMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Child&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">);</span> <span class="c1">// {name: &quot;parent&quot;, age: 50}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">GrandChild</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">GrandChild</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">contextTypes</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">name</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">componentDidMount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;GrandChild&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">);</span> <span class="c1">// {name: &quot;parent&quot;}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">hello</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">React</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Parent</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>react-router</code>ではparentベースのcontextに依存していたので対応が大変そうでした。</p>

<h3>問題点</h3>

<ul>
<li>ownerは密かにReactElementに追加されているので気づかないうちに挙動が変わることが発生します。↓の場合はそれぞれのinputのownerが異なりますし、<code>React.addons.cloneWithProps</code>を使った場合もownerが変わります。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'><span class="kr">class</span> <span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">bar</span> <span class="o">?</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span> <span class="o">/&gt;</span> <span class="o">:</span> <span class="nx">foo</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>ownerは実行時のstackによって決定します。↓の場合、<code>span</code>のonwerは実際は<code>B</code>で<code>A</code>ではありません。これはcallbackが実行されたタイミングに依存するからです。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">class</span> <span class="nx">A</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">B</span> <span class="nx">renderer</span><span class="o">=</span><span class="p">{</span><span class="nx">text</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/span&gt;} /</span><span class="o">&gt;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="kr">class</span> <span class="nx">B</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">renderer</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>また、JSXが書いているscope内にReactが必要なのは、Reactが現在のownerを保持していてJSXの変換がそれに依存しているからという意外なところに影響があったりもします。</li>
</ul>


<h3>それに対する提案</h3>

<ul>
<li>ownerベースのcontextの代わりにparentベースのcontextの導入を考えているのでそれを使うことです。ほとんどのケースはparentベースのcontextでも問題ないです。</li>
<li>ownerベースのcontextが必要になる場合はほとんどないはずだしコードを見直すべきです。</li>
</ul>


<h3>未解決</h3>

<ul>
<li><code>ref</code>はまだownerベースのままで、これについてはまだ完全に解決出来ていません。

<ul>
<li>v0.13ではcallbackでもrefが定義出来るようなりましたがこれまでの宣言的な定義方法も残されています。宣言的な定義方法に代わる何かいい方法がない限りこのAPIは廃止されません。</li>
</ul>
</li>
</ul>


<h2><code>{key: element}</code>(Keyed Object)の形式でchildに渡すとwarningが出るようになりました</h2>

<p>v0.12では<code>{key: element}</code>の形式でkeyが指定したらelementを渡すことが出来ましたが、これはあまり使われてないし問題となる場合があるので使うべきではないのでwarningが出るようになりました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="o">/&gt;</span><span class="p">}</span> <span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>問題点</h3>

<ul>
<li>列挙される順番はkeyに数値を指定した場合を除いては仕様として定義されてないので実装次第になってしまいます。</li>
<li>一般的にobjectをmapとして扱うことは型システムやVMの最適化やコンパイラーにとって好ましくないし、さらにセキュリティ上のリスクもあって↓のような場合にもし<code>item.title === '__proto__'</code> を指定されたら&hellip;.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'><span class="nx">items</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="nx">children</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="o">/&gt;</span><span class="p">);</span>
</span><span class='line'><span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">children</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>それに対する解決</h3>

<ul>
<li>ほとんどの場合、<code>key</code>を設定したReactElementの配列にすれば問題ないはずです。</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="nx">items</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">);</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">children</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>this.props.children</code>を使った場合など、<code>key</code>を指定することが出来ない場合もあるかもしれません。その場合はv0.13で追加された<code>React.addons.createFragment</code>を使うことでKeyed ObjectからReactElementを作成することが出来ます。

<ul>
<li>注意として、これはまだrenderの戻り値として直接渡せるものではないので<div>などでラップしてあげる必要があります。</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">React</span><span class="p">.</span><span class="nx">addons</span><span class="p">.</span><span class="nx">createFragment</span><span class="p">({</span> <span class="nx">a</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">div</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span> <span class="p">})}</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2><code>React.cloneElement</code>が追加されました</h2>

<p>これはこれまで<code>React.addons.cloneWithProps</code>と似たAPIです。
異なる点としては、<code>style</code>や<code>className</code>のmergeが行われなかったり<code>ref</code>が保持される点があります。
<code>cloneWithProps</code>を使ってchildrenを複製した時に<code>ref</code>が保持されなくて問題となるという報告が多くあったのでこのAPIでは<code>ref</code>を保持するようになりました。
<code>cloneElement</code>時に<code>ref</code>を指定すると上書きされます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">newChildren</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Children</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">cloneElement</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="p">{</span> <span class="nx">foo</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>このAPIはv0.13でPropがimmutableなものとして扱われるようになったことで、Propを変更するためにelementをcloneする機会が増えたため必要となりました。
<code>React.addons.cloneWithProps</code>はそのうちdeprecateになりますが今回のタイミングではなりません。</p>

<h2><code>React.addons.classSet</code>がdeprecatedになりました</h2>

<p>必要な場合は<a href="https://www.npmjs.com/package/classnames">classnames</a>などを使用してください。</p>

<h2>jsxコマンドで<code>--target</code>optionとしてECMAScript versionを指定出来るようになりました。 (Breaking Change)</h2>

<p><code>es5</code>がデフォルトです。
<code>es3</code>はこれまでの挙動ですが追加で予約語を安全に扱うようになりました(eg <code>this.static</code>は<code>this['static']</code>にIE8での互換性のために変換されます)。</p>

<h2>jsxコマンドでES6 syntaxで変換した際にclassメソッドがdefaultではenumerableではなくなりました</h2>

<p><code>Object.defineProperty</code>を使用しているため、IE8などをサポートしたい場合は<code>--target es3</code>optionを渡す必要があります。</p>

<ul>
<li>Original</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">class</span> <span class="nx">Hello</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">hello</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">Hello</span><span class="p">.</span><span class="kr">static</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">bar</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>ES5</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">____Class0</span><span class="o">=</span><span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">____Class0____Key</span> <span class="k">in</span> <span class="nx">____Class0</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">____Class0</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">____Class0____Key</span><span class="p">)){</span><span class="nx">Hello</span><span class="p">[</span><span class="nx">____Class0____Key</span><span class="p">]</span><span class="o">=</span><span class="nx">____Class0</span><span class="p">[</span><span class="nx">____Class0____Key</span><span class="p">];}}</span><span class="kd">var</span> <span class="nx">____SuperProtoOf____Class0</span><span class="o">=</span><span class="nx">____Class0</span><span class="o">===</span><span class="kc">null</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">____Class0</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">____SuperProtoOf____Class0</span><span class="p">);</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="o">=</span><span class="nx">Hello</span><span class="p">;</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">__superConstructor__</span><span class="o">=</span><span class="nx">____Class0</span><span class="p">;</span><span class="kd">function</span> <span class="nx">Hello</span><span class="p">(){</span><span class="s2">&quot;use strict&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">____Class0</span><span class="o">!==</span><span class="kc">null</span><span class="p">){</span><span class="nx">____Class0</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">);}}</span>
</span><span class='line'>  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span><span class="s2">&quot;foo&quot;</span><span class="p">,{</span><span class="nx">writable</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">configurable</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}});</span>
</span><span class='line'>  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span><span class="s2">&quot;render&quot;</span><span class="p">,{</span><span class="nx">writable</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">configurable</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s2">&quot;hello&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Hello</span><span class="p">.</span><span class="kr">static</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">bar</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>ES3</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">____Class0</span><span class="o">=</span><span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">____Class0____Key</span> <span class="k">in</span> <span class="nx">____Class0</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">____Class0</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">____Class0____Key</span><span class="p">)){</span><span class="nx">Hello</span><span class="p">[</span><span class="nx">____Class0____Key</span><span class="p">]</span><span class="o">=</span><span class="nx">____Class0</span><span class="p">[</span><span class="nx">____Class0____Key</span><span class="p">];}}</span><span class="kd">var</span> <span class="nx">____SuperProtoOf____Class0</span><span class="o">=</span><span class="nx">____Class0</span><span class="o">===</span><span class="kc">null</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">____Class0</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">____SuperProtoOf____Class0</span><span class="p">);</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span><span class="o">=</span><span class="nx">Hello</span><span class="p">;</span><span class="nx">Hello</span><span class="p">.</span><span class="nx">__superConstructor__</span><span class="o">=</span><span class="nx">____Class0</span><span class="p">;</span><span class="kd">function</span> <span class="nx">Hello</span><span class="p">(){</span><span class="s2">&quot;use strict&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">____Class0</span><span class="o">!==</span><span class="kc">null</span><span class="p">){</span><span class="nx">____Class0</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">);}}</span>
</span><span class='line'>  <span class="nx">Hello</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">foo</span><span class="o">=</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="nx">Hello</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">render</span><span class="o">=</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s2">&quot;hello&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Hello</span><span class="p">[</span><span class="s2">&quot;static&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">bar</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<h2>JSXによる変換でharmony optionを有効にすることでspread operatorを使えるようになりました</h2>

<p>JSXの中ではこれまでもspread attributesとしてサポートしていましたが、JSのコード内でも使えるようになりました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="p">[</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="p">...</span><span class="nx">other</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>JSXのparseに変更があります (Breaking Change)</h2>

<p>elementの内側に<code>&gt;</code> or <code>}</code> を使った時に以前は文字列として扱われましたがparseエラーになるようになりました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">}</span> <span class="nx">or</span> <span class="o">&gt;&lt;</span><span class="sr">/div&gt;; /</span><span class="o">/</span> <span class="nx">parse</span> <span class="nx">error</span><span class="o">!</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>v0.14に向けて</h2>

<p>今回の変更を踏まえてReact v0.14では静的な要素においていくつかの最適化が可能になります。
これらの最適化は以前はtemplate-baseなフレームワークでのみ可能でしたが、ReactでもJSXと<code>React.createElement/Factory</code>のどちらでも可能になります。</p>

<p>詳細は下記のissueにあります。
まだ議論もされてないので変わる可能性は大きいと思いますが。</p>

<h3>Reuse Constant Value Types</h3>

<ul>
<li><a href="https://github.com/facebook/react/issues/3226">https://github.com/facebook/react/issues/3226</a></li>
</ul>


<p>これは静的なelementに変更できないものとして扱うことでdiffのコストを減らすというものです。</p>

<p>例えばこんな感じにするとか</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>   <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="err">↓</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>   <span class="k">return</span> <span class="nx">foo</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Tagging ReactElements</h3>

<ul>
<li><a href="https://github.com/facebook/react/issues/3227">https://github.com/facebook/react/issues/3227</a></li>
</ul>


<p>これはReactElementにtag付けをしてそれを使ってdiffアルゴリズムを最適化するというもののようです。</p>

<h3>Inline ReactElements</h3>

<ul>
<li><a href="https://github.com/facebook/react/issues/3228">https://github.com/facebook/react/issues/3228</a></li>
</ul>


<p>これはproductionビルドのときに、React.createElementではなくてinline objectに変換することでReact.createElementのコストを削減するというものです。</p>

<p>こんな感じ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">bar</span><span class="p">}</span><span class="o">&lt;</span><span class="nx">Baz</span> <span class="nx">key</span><span class="o">=</span><span class="s2">&quot;baz&quot;</span> <span class="o">/&gt;&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'><span class="err">↓</span>
</span><span class='line'><span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="nx">props</span><span class="o">:</span> <span class="p">{</span> <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="nx">children</span><span class="o">:</span>
</span><span class='line'>  <span class="p">[</span> <span class="nx">bar</span><span class="p">,</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">Baz</span><span class="p">,</span> <span class="nx">props</span><span class="o">:</span> <span class="p">{</span> <span class="p">},</span> <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="nx">ref</span><span class="o">:</span> <span class="kc">null</span> <span class="p">}</span> <span class="p">]</span>
</span><span class='line'><span class="p">},</span> <span class="nx">key</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">ref</span><span class="o">:</span> <span class="kc">null</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>こうするとReact.createElementの時に行っているPropTypesやkeyに対するvalidationが出来ないので、developmentビルドの時には適用しないことを想定しているようです。</p>

<hr />

<p>というわけで、React v0.13をダラダラと書いてみました。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[React v0.13.0 Beta1でclassでComponentが作れるようになった]]></title>
    <link href="http://blog.koba04.com/post/2015/01/28/published-react-v0.13.0-beta1/"/>
    <updated>2015-01-28T17:20:35+09:00</updated>
    <id>http://blog.koba04.com/post/2015/01/28/published-react-v0.13.0-beta1</id>
    <content type="html"><![CDATA[<p>React.js Confの前日にv0.13.0 Beta1がnpmにpublishされました。</p>

<p><a href="http://facebook.github.io/react/blog/2015/01/27/react-v0.13.0-beta-1.html">http://facebook.github.io/react/blog/2015/01/27/react-v0.13.0-beta-1.html</a></p>

<p>featureは色々あるみたいですが、↑のブログにはその1つとしてClassによるReact Componentの作成が紹介されていたのでそれについて書きたいと思います。</p>

<p>ちなみに<code>React.createClass</code>を使う場合はこれまでと同じままで大丈夫なはずです。</p>

<!-- more -->


<h2>ES6 Classes</h2>

<p><code>React.createClass</code>ではなくて、ES6のclassを使って↓みたいな感じで書けるようになります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">import</span> <span class="p">{</span><span class="nx">React</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Hello</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">val</span><span class="o">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">foo</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">};</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">onClick</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">val</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">val</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">state</span> <span class="nx">is</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">val</span><span class="p">}.</span> <span class="nx">props</span> <span class="nx">is</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">foo</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onClick</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="o">&gt;</span><span class="nx">click</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">Hello</span><span class="p">.</span><span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">foo</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>ポイントとしては</p>

<ul>
<li><code>React.Component</code>をextendsします。</li>
<li><code>constructor</code>に<code>props</code>が引数として渡ってくるのでそれを使って必要に応じて<code>state</code>の初期化をする。

<ul>
<li><code>getInitialState</code>は使うことができません。(warnが出ます)</li>
</ul>
</li>
<li>Autobindingはされなくなったので明示的に<code>this.onClick.bind(this)</code>のようにする必要があります。</li>
<li><code>propTypes</code>や<code>defaultProps</code>はconstructorのpropertyとして指定する必要があります。</li>
<li>現時点で<code>mixin</code>はclassで書いた場合は使うことができません。</li>
</ul>


<p>といった辺りです。</p>

<h3>変換</h3>

<p>ES6のコードの変換は、これまで通りreact-toolsでjsxの<code>--harmony</code>optionを有効にしたり6to5使ったりする感じです。</p>

<h3>今後</h3>

<p>今の書き方だと微妙に感じるところも結構あるのですが、最終的には↓のような形で書けるようにしたいみたいです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">import</span> <span class="p">{</span><span class="nx">React</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Hello</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">foo</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span> <span class="p">};</span>
</span><span class='line'>  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">val</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">foo</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">};</span>
</span><span class='line'>  <span class="nx">onClick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">val</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">val</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">});</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">state</span> <span class="nx">is</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">val</span><span class="p">}.</span> <span class="nx">props</span> <span class="nx">is</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">foo</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onClick</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">click</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>mixinについてはreact-futureを見る限りこんな感じになるのかもしれないですね。</p>

<p><a href="https://github.com/reactjs/react-future/blob/master/01%20-%20Core/02%20-%20Mixins.js">https://github.com/reactjs/react-future/blob/master/01%20-%20Core/02%20-%20Mixins.js</a></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">import</span> <span class="p">{</span> <span class="nx">mixin</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;react-utils&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;react&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">const</span> <span class="nx">A</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kr">super</span><span class="p">();</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kr">class</span> <span class="nx">Hello</span> <span class="kr">extends</span> <span class="nx">mixin</span><span class="p">(</span><span class="nx">Component</span><span class="p">,</span> <span class="nx">A</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span> <span class="o">/&gt;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CoffeeScript &amp; TypeScript</h3>

<p>ちなみにES6だけでなく、CoffeescriptやTypeScriptのClass syntaxでもかけます。</p>

<hr />

<p>React.js自体でやることを減らしてES6、7のfeatureに任せることが出来るところは任せようといった方向性を感じて個人的にはいいんじゃないかと思っています。</p>

<p>React.js Conf行きたかった&hellip;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A combination of React.js and 6to5]]></title>
    <link href="http://blog.koba04.com/post/2015/01/13/a-combination-of-reactjs-and-6to5/"/>
    <updated>2015-01-13T18:50:28+09:00</updated>
    <id>http://blog.koba04.com/post/2015/01/13/a-combination-of-reactjs-and-6to5</id>
    <content type="html"><![CDATA[<p>In English article is <a href="http://en.blog.koba04.com/2015/02/04/a-combination-of-reactjs-and-6to5/">here</a>.</p>

<p>今までは、react-toolsを使ってjsxのharmony optionを有効にして書くことで一部のES6のfeatureが使えて満足していたのですが、azuさんの記事を見て6to5を試したくなったのでReact.js + 6to5の組み合わせで書いてみました。</p>

<ul>
<li><a href="https://6to5.org/">https://6to5.org/</a></li>
<li><a href="http://efcl.info/2015/01/09/write-es6/">http://efcl.info/2015/01/09/write-es6/</a></li>
</ul>


<p>結論から言うと6to5自体がjsxのサポートもしているので何も意識することなく書けていい感じでした。</p>

<p>コードはこんな感じ。</p>

<p><a href="https://github.com/koba04/react-boilerplate">https://github.com/koba04/react-boilerplate</a></p>

<!-- more -->


<h2>structure</h2>

<h3>browserify + 6to5ify</h3>

<p>変換の流れはbrowserifyのtransformである6to5ifyを使うので、</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ES6  -&gt;   CommonJS(ES5)      -&gt;       bundle.js
</span><span class='line'>    6to5                 browserify</span></code></pre></td></tr></table></div></figure>


<p>な形になっています。</p>

<p>AltJSで書くときと同じ流れです。</p>

<h2>configuration</h2>

<p><a href="https://github.com/koba04/react-boilerplate/blob/master/package.json">https://github.com/koba04/react-boilerplate/blob/master/package.json</a></p>

<h3>bundle.js</h3>

<p>bundle.jsの作成はただ、6to5ifyをtransformとして指定するだけです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="s2">&quot;scripts&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;watch&quot;</span><span class="o">:</span> <span class="s2">&quot;watchify app/index.js -o dist/bundle.js -v&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;build&quot;</span><span class="o">:</span> <span class="s2">&quot;browserify app/index.js &gt; dist/bundle.js&quot;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s2">&quot;browserify&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;transform&quot;</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>      <span class="p">[</span> <span class="s2">&quot;6to5ify&quot;</span> <span class="p">]</span>
</span><span class='line'>    <span class="p">]</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>start server</h3>

<p>serverを立ち上げる時は、entry pointとなるserver.jsもES6で書きたいので、6to5に含まれている<code>6to5-node</code>コマンドを利用します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="s2">&quot;scripts&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;start&quot;</span><span class="o">:</span> <span class="s2">&quot;6to5-node server&quot;</span>
</span><span class='line'>  <span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>これによってserver.jsもES6で書くことが出来るようになります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">import</span> <span class="nx">express</span>  <span class="nx">from</span> <span class="s1">&#39;express&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">React</span>    <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">App</span>      <span class="nx">from</span> <span class="s1">&#39;./app/components/App&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">let</span> <span class="nx">app</span>     <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span><span class='line'><span class="kd">let</span> <span class="nx">handler</span> <span class="o">=</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">let</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">renderToString</span><span class="p">(</span><span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">path</span><span class="o">:</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nx">name</span>
</span><span class='line'>    <span class="p">}));</span>
</span><span class='line'>    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span>        <span class="nx">handler</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/artist&#39;</span><span class="p">,</span>  <span class="nx">handler</span><span class="p">(</span><span class="s1">&#39;artist&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/country&#39;</span><span class="p">,</span> <span class="nx">handler</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span><span class="o">+</span><span class="s1">&#39;/dist&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="kd">let</span> <span class="nx">port</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">5000</span><span class="p">;</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;listening...&quot;</span> <span class="o">+</span> <span class="nx">port</span><span class="p">);</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>test by Jest</h3>

<p>Jestのテストについても<code>6to5-jest</code>というmoduleがあるのでそれをinstallして、scriptPreprocessorに指定するだけです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="s2">&quot;jest&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;scriptPreprocessor&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;rootDir&gt;/node_modules/6to5-jest&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>こんな感じで書けます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">jest</span><span class="p">.</span><span class="nx">dontMock</span><span class="p">(</span><span class="s1">&#39;../InputArtist&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kr">import</span> <span class="nx">React</span>                    <span class="nx">from</span> <span class="s1">&#39;react/addons&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">InputArtist</span>              <span class="nx">from</span> <span class="s1">&#39;../InputArtist&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">AppTracksActionCreators</span>  <span class="nx">from</span> <span class="s1">&#39;../../actions/AppTracksActionCreators&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;inputArtist&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">let</span> <span class="nx">inputArtist</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">inputArtist</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">addons</span><span class="p">.</span><span class="nx">TestUtils</span><span class="p">.</span><span class="nx">renderIntoDocument</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">InputArtist</span> <span class="o">/&gt;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">,</span>  <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="s2">&quot;set inputArtist radiohead&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">expect</span><span class="p">(</span><span class="nx">inputArtist</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">inputArtist</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s2">&quot;radiohead&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;handleSubmit&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">let</span> <span class="nx">preventDefault</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">preventDefault</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">genMockFunction</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">inputArtist</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">inputArtist</span><span class="o">:</span> <span class="s1">&#39;travis&#39;</span> <span class="p">});</span>
</span><span class='line'>      <span class="nx">React</span><span class="p">.</span><span class="nx">addons</span><span class="p">.</span><span class="nx">TestUtils</span><span class="p">.</span><span class="nx">Simulate</span><span class="p">.</span><span class="nx">submit</span><span class="p">(</span><span class="nx">inputArtist</span><span class="p">.</span><span class="nx">getDOMNode</span><span class="p">(),</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">preventDefault</span><span class="o">:</span> <span class="nx">preventDefault</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>    <span class="nx">it</span> <span class="p">(</span><span class="s2">&quot;calls AppTracksActionCreators.fetchByArtist with state.inputArtist&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">expect</span><span class="p">(</span><span class="nx">AppTracksActionCreators</span><span class="p">.</span><span class="nx">fetchByArtist</span><span class="p">).</span><span class="nx">toBeCalled</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">expect</span><span class="p">(</span><span class="nx">AppTracksActionCreators</span><span class="p">.</span><span class="nx">fetchByArtist</span><span class="p">).</span><span class="nx">toBeCalledWith</span><span class="p">(</span><span class="s1">&#39;travis&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>    <span class="nx">it</span> <span class="p">(</span><span class="s2">&quot;calls e.preventDefault&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">expect</span><span class="p">(</span><span class="nx">preventDefault</span><span class="p">).</span><span class="nx">toBeCalled</span><span class="p">();</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>code</h2>

<h3>JSX</h3>

<p>6to5ではjsxもサポートしているので、何も意識することなくjsxを書いておくことが出来ます。</p>

<p><a href="https://6to5.org/docs/usage/jsx/">https://6to5.org/docs/usage/jsx/</a></p>

<h3>ES6 modules</h3>

<p>今までは、ES6を感じながらcommonJS styleで書くのもちょっとなぁという気持ちがありましたがこれによってES6 modulesのstyleで書くことが出来ていい感じです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">import</span> <span class="nx">React</span>        <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">Nav</span>          <span class="nx">from</span> <span class="s1">&#39;./Nav&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">Footer</span>       <span class="nx">from</span> <span class="s1">&#39;./Footer&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">InputArtist</span>  <span class="nx">from</span> <span class="s1">&#39;./InputArtist&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">Tracks</span>       <span class="nx">from</span> <span class="s1">&#39;./Tracks&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="nx">TrackStore</span>   <span class="nx">from</span> <span class="s1">&#39;../stores/TrackStore&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">displayName</span><span class="o">:</span> <span class="s1">&#39;Artist&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">let</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">title</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">fontFamily</span><span class="o">:</span> <span class="s2">&quot;&#39;Poiret One&#39;, cursive&quot;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">(</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">header</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;page-header&quot;</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="o">&lt;</span><span class="nx">h1</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">style</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Artist</span> <span class="nx">Top</span> <span class="nx">Tracks</span> <span class="o">&lt;</span><span class="nx">small</span><span class="o">&gt;</span><span class="nx">by</span> <span class="nx">Last</span><span class="p">.</span><span class="nx">FM</span><span class="o">&lt;</span><span class="err">/small&gt;&lt;/h1&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="err">/header&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">Nav</span> <span class="nx">current</span><span class="o">=</span><span class="s2">&quot;artist&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">article</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;main-content&quot;</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="o">&lt;</span><span class="nx">InputArtist</span> <span class="o">/&gt;</span>
</span><span class='line'>          <span class="o">&lt;</span><span class="nx">Tracks</span> <span class="o">/&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="err">/article&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">Footer</span> <span class="o">/&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>直接export defaultにComponentのClassを渡しているので、displayNameは明示的に指定しています。</p>

<hr />

<p>というわけでReact.jsのコードを6to5使ってES6で簡単に書くことが出来るという話でした。</p>

<p>個人的には今後書くコードはES6で書いていきたい感じです。</p>

<p>6to5シンプルに使えていいですね。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Looking back 2014]]></title>
    <link href="http://blog.koba04.com/post/2014/12/31/looking-back-2014/"/>
    <updated>2014-12-31T22:18:22+09:00</updated>
    <id>http://blog.koba04.com/post/2014/12/31/looking-back-2014</id>
    <content type="html"><![CDATA[<p>2014年の振り返りということで。</p>

<h2>最初にまとめ</h2>

<p>2014年は</p>

<ul>
<li>英語を避けない</li>
<li>inputしたものは全てoutputする</li>
</ul>


<p>という2点をポイントとして考えていたのですが、もっとOSSにcontributeしたかったなぁという感じです。</p>

<p>React.jsも結局documentの修正をpull requestしたくらいだったので&hellip;。</p>

<p>ちなみにReact.jsのAdvent Calendarは薄い本形式で書いてもいいかなと思ったのですが、それをするにも一度知っていることを全部出して整理しておきたいなという意味で書きました。</p>

<p>来年に書きたいモチベーションがあれば書くかも。</p>

<p>2015年は内容のあるアウトプットをしたいところです。</p>

<!-- more -->


<h2>以下Tweetで振り返る</h2>

<p>完全に自分用です。</p>

<blockquote class="twitter-tweet" lang="en"><p>日記書いた「GalaxyS4のWebviewでのCanvasがおかしい件の解決方法」 <a href="http://t.co/eTTS6RfXD1">http://t.co/eTTS6RfXD1</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/421568611971387392">January 10, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>




<blockquote class="twitter-tweet" lang="en"><p>2014年最初のエントリがAndroidの機種依存のバグ対応についてとかだいぶ前途多難感がある</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/421661190800936960">January 10, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>新年早々、Androidのバグに遭遇していたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>“Introduction to React // Speaker Deck” <a href="http://t.co/X5ea2haYgQ">http://t.co/X5ea2haYgQ</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/425472004771172352">January 21, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>一応React.jsについては見ていたみたいですがこの時点ではスルーしていたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>日記書いた「Marionette.js in Single Page Applicationという話をした」 <a href="http://t.co/yEF0uQYo25">http://t.co/yEF0uQYo25</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/425574026891624448">January 21, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Marionette.jsについて社内勉強会で話したみたいです。</p>

<blockquote class="twitter-tweet" lang="en"><p>ライトなMVVMのフレームワークかな / “vue.js” <a href="http://t.co/AeqbyAt5AZ">http://t.co/AeqbyAt5AZ</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/430502612278841344">February 4, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>vue.jsについても興味を持っていたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>node-webkitってそういうことだったのか。名前だけでPhantomJSみたいなもんだと思ってたｗ</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/430707052223012865">February 4, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>node-webkitについて認識したようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>日記書いた「さようならはてなダイアリー、ありがとうはてなダイアリー」 <a href="http://t.co/CjACcmDF4Q">http://t.co/CjACcmDF4Q</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/440140794402316288">March 2, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>はてなダイアリーから移行しました。</p>

<blockquote class="twitter-tweet" lang="en"><p>posted blog “npmとbowerライブラリのバージョン管理” <a href="http://t.co/eRxP3dMo8S">http://t.co/eRxP3dMo8S</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/440528560424353792">March 3, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>npmの依存性の解決とかどうなるのって思って書いたエントリーです。npm-shrinkwrap教えてもらいました。</p>

<blockquote class="twitter-tweet" lang="en"><p>testem、ファイルが増えてくると最初の立ち上げがものすごく遅くなるし、specまとめると毎回の起動が遅くなるしどうしたらいいの&#8230;.</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/441906651063271424">March 7, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>testemが辛くなってきたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>browserify、よくわからなくて面白い。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/446090322280329216">March 19, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>browserifyについて興味を持ったようですがよくわかってないようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>node-webkitやっぱ面白いなぁ</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/446283446894071810">March 19, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>node-webkitに興味を持っているようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>Posted new entry &quot;browserify in Backbone.Marionette project&quot; <a href="http://t.co/ALM8atVdRZ">http://t.co/ALM8atVdRZ</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/447875601546768384">March 23, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>browserifyを試しているみたいです。</p>

<blockquote class="twitter-tweet" lang="en"><p>node-webkitはscriptタグで読み込んだ時はwindowのcontextでrequireした先はnodeのcontextになるのか。だからvue.jsみたいなrequireでdocument参照してるライブラリ読み込むとエラーになるのかー。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/449169127077212162">March 27, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>node-webkitのcontextの扱いについて悩んでいるようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>フロント側、開発効率を上げつつyak率を抑えるバランスが難しい</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/449555088327979009">March 28, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>色々フロントエンドで取り入れていてちょっとやり過ぎ感を感じているようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>espowerifyも出たから次のテストはpower-assertで書いてみよう</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/450447992416264192">March 31, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>power-assertで書くことを決めたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>Uターンして株式会社はてなに入社したい</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/450803394756628480">April 1, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>何故かはてなに入社したいと思っていたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>semver運動もいいけど、changelog設置しよう運動もお願いしたいところ</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/454283994981359617">April 10, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>changelogなくて辛かったらしい。</p>

<blockquote class="twitter-tweet" lang="en"><p>Webサイト的なものを作る時にフロントのJavaScriptどうするか大変悩ましい。SEO的に。AjaxSEO(なんて括るのかわからん)みたいなサービス使うだけでいいならだいぶ楽だけど。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/455678860760068098">April 14, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>SPAでのSEOについてどうすんのと考えていたらしい。仕事はSEO関係ない世界でやってたけど。</p>

<blockquote class="twitter-tweet" lang="en"><p>はぁ、やっとVue.jsのGuideとAPIのところ読み終わった。。スライドにでもまとめるかな・・・ <a href="https://t.co/AJ1FOq7LEl">https://t.co/AJ1FOq7LEl</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/455726759502041088">April 14, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>vue.jsのドキュメントを読んでいたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>イベントの実装、既存の機能をどんどん汚していくような感じになってツライ</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/456374359867678720">April 16, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>イベントの実装で悩んでいたらしい。</p>

<blockquote class="twitter-tweet" lang="en"><p>ブログ書いた「Reusable components by Vue.js and Browserify」 <a href="http://t.co/DRjEtoEYkK">http://t.co/DRjEtoEYkK</a> ちょっとタイトルと内容が違うけど、、。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/456570783368622080">April 16, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>この辺りからComponentを意識し始めていたみたい。</p>

<blockquote class="twitter-tweet" lang="en"><p>わーい、Vue.jsの作者に日本語でありがとうって言われた！(translateではないけど・・) <a href="https://t.co/dwTXDGZttT">https://t.co/dwTXDGZttT</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/456628489991360512">April 17, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>承認欲求が満たされたみたい。</p>

<blockquote class="twitter-tweet" lang="en"><p>nodeでフロントにサーバー立てる構成ちょっとやってみたい</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/456792479337951232">April 17, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>これはずっと思ってる。</p>

<blockquote class="twitter-tweet" lang="en"><p>答えたい質問があったのでstackoverflowに登録した</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/456952402441027584">April 18, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>stackoverflowデビュー。確かvue.jsについての質問に答えた。</p>

<blockquote class="twitter-tweet" lang="en"><p>ロシア語とかで面白そうな記事を見たりすると、日本語じゃなくて英語で書こうかなーとかちょっと思ったりするけど、そうすると(英語が酷すぎて)誰も読めなくなるので自重してる。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/458518498189127680">April 22, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>英語力の低さを嘆いてる。</p>

<blockquote class="twitter-tweet" lang="en"><p>2050年になったらコケるテスト書いた</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/458873755385593856">April 23, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>罠を仕込んだ。</p>

<blockquote class="twitter-tweet" lang="en"><p>ついに「iTunes Match 終わらない」でググってしまった…</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/464030008843849728">May 7, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>iTunes Matchに消耗してた。</p>

<blockquote class="twitter-tweet" lang="en"><p>子育てエンジニア飲み会を企画してやろうかなという気分になってる。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/465717911856750592">May 12, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>今年こそは！</p>

<blockquote class="twitter-tweet" lang="en"><p>Angular.js、いつまで経ってもfactoryとserviceとproviderの違いについてのpostがいっぱい出てくるので見直した方がいいのでは感ある。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/466451268232564736">May 14, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>はい。</p>

<blockquote class="twitter-tweet" lang="en"><p>続きを読むにはイイねをみたい記事、HTTPリクエストの無駄だから滅んでほしい。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/470899883998601216">May 26, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>マジで。</p>

<blockquote class="twitter-tweet" lang="en"><p>これ、ものすごい大事な発表やんか。 / “Google ウェブマスター向け公式ブログ: ウェブページをより深く理解するようになりました” <a href="http://t.co/4CeKj7De5D">http://t.co/4CeKj7De5D</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/470935988789723136">May 26, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Googleだけどうにか出来ればいいわけではないけど、大きな一歩。</p>

<blockquote class="twitter-tweet" lang="en"><p>node-webkitのwikiのTOPに&quot;I know most of you just don&#39;t read documentations&quot; て書いてあるｗ</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/471304537404219394">May 27, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>www</p>

<blockquote class="twitter-tweet" lang="en"><p>メモリリークしてるコード見つけるとテンションがあがる。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/472296743074148352">May 30, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>メモリリークを探していたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>1人で子ども2人の面倒見ながらのalert対応、だいぶ厳しい感ある。見れるけどコード書けない。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/472633096718651393">May 31, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>子どもはキーボードが大好き。</p>

<blockquote class="twitter-tweet" lang="en"><p>&quot;Mithril and React use virtual DOM diffing &quot; 気になる。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/473975523194847232">June 3, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Virtual DOMにも興味を持っていたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>HTTP 1.1での最適化がHTTP 2.0だと悪影響になるって面白いな。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/474884509242904576">June 6, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>ハイパフォーマンスブラウザネットワーキングを読んでいたようです。</p>

<blockquote class="twitter-tweet" lang="en"><p><a href="https://twitter.com/hashtag/%E6%9A%87?src=hash">#暇</a> <a href="http://t.co/DSt4esbPDh">pic.twitter.com/DSt4esbPDh</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/476382524105424896">June 10, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>暇だったらしい。</p>

<blockquote class="twitter-tweet" lang="en"><p>レビューを指名制から出来る人が取る方式に変えてみたけどうまくいくかなー。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/477033635086745600">June 12, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>レビューをうまく回したかったらしい。</p>

<blockquote class="twitter-tweet" lang="en"><p>Marionette 2.0 release notes in Japanese&#10;&#10;<a href="http://t.co/VLItT4JDHy">http://t.co/VLItT4JDHy</a>&#10;&#10;Thanks <a href="https://twitter.com/koba04">@koba04</a></p>&mdash; Backbone.Marionette (@marionettejs) <a href="https://twitter.com/marionettejs/status/479635101555638272">June 19, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>紹介されて嬉しかった。</p>

<blockquote class="twitter-tweet" lang="en"><p>Karmaについて書いた。 &quot;Karma for JavaScript test runner&quot; <a href="http://t.co/yS5YW4xHgz">http://t.co/yS5YW4xHgz</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/481220465571024897">June 23, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>testemからKarmaに移行したようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>Vue.jsもくもく会 <a href="https://twitter.com/hashtag/2%E3%81%AB%E5%8F%82%E5%8A%A0%E3%81%97%E3%81%BE%E3%81%99?src=hash">#2に参加します</a>！ vue.js bookの続きを書かねば&#8230; <a href="http://t.co/M4jZZR34kY">http://t.co/M4jZZR34kY</a> <a href="https://twitter.com/hashtag/vuejs_mkmk?src=hash">#vuejs_mkmk</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/482535242687709184">June 27, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Vue.jsもくもく会にも参加してた。途中から行けなくなってしまったけど&hellip;。</p>

<blockquote class="twitter-tweet" lang="en"><p>そういえばVue.jsのEvanからいきなりメール来てビビったんだけど、Vue.jsで改善したい項目あれば教えてもらえれば伝えておきますよ。日本人の意見も聞きたいらしい。 このissueに書いてもよさそうだけど。 <a href="https://t.co/nr0fA4xGYZ">https://t.co/nr0fA4xGYZ</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/483422819053621248">June 30, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Evanからメール来て残念な英語でメールを返信した。</p>

<blockquote class="twitter-tweet" lang="en"><p>英語で文章書くの時間掛かるし、issueみたいなのじゃなくて考え説明するの伝わる気がしない…</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/483603220304896002">June 30, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>英語力&hellip;。</p>

<blockquote class="twitter-tweet" lang="en"><p>Reactかぁー見てみよう / “Atom Blog” <a href="http://t.co/eNzaWCXkur">http://t.co/eNzaWCXkur</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/484547742782337024">July 3, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>React.jsを調べてみようと思ったタイミングです。</p>

<blockquote class="twitter-tweet" lang="en"><p>今日は天下一クライアントサイドJS MV\*フレームワーク武道会でLTとパネルやります！ドキドキ&#8230; <a href="http://t.co/oI5ae94l3f">http://t.co/oI5ae94l3f</a> <a href="https://twitter.com/hashtag/ten1club?src=hash">#ten1club</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/487529507675320321">July 11, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>JS関連で初めて外で話したイベント。</p>

<blockquote class="twitter-tweet" lang="en"><p>VirtualDOM難しい…。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/492309911032713216">July 24, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Virtual DOMの何が難しかったのだろうか&hellip;。</p>

<blockquote class="twitter-tweet" lang="en"><p>ZombieView見つけて直すの楽しい</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/494411375251177472">July 30, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>ZombieViewを退治してようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>面白い話がいっぱい聞けると思うので是非来て下さい！ / “今年のYAPC前夜祭は「Webアプリ10連発」！ - YAPC::Asia Tokyo 2014” <a href="http://t.co/5RxK36NsNG">http://t.co/5RxK36NsNG</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/499040965420519426">August 12, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>YAPCの前夜祭の手伝いをしていたみたいです。</p>

<blockquote class="twitter-tweet" lang="en"><p>最近Reactのドキュメントをちょいちょい読んでる</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/501892377544364032">August 20, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>React.jsのドキュメント読み始めてる。</p>

<blockquote class="twitter-tweet" lang="en"><p>誰も幸せにならない感じのソースを久々に見た</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/502612257977954306">August 22, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>何だろう。気になる&hellip;。</p>

<blockquote class="twitter-tweet" lang="en"><p>「よし、次のプロジェクトではReact使うぞ！」って言って嫌な顔されたい</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/502612835009318912">August 22, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>React.js気に入ってるみたい。</p>

<blockquote class="twitter-tweet" lang="en"><p>いやー、typesterさんの話、本当によかった。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/505672825202434048">August 30, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>YAPCのtypesterさんの話よかった。</p>

<blockquote class="twitter-tweet" lang="en"><p>isomorphicを実現するためにReactを使うの盛り上がっていきそうだな。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/509487375710289920">September 9, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>isomorphicにも興味を持っているようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>社内で話したやつ(ちょっと手を加えたけど) <a href="http://t.co/bMAObYgQfa">http://t.co/bMAObYgQfa</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/516458323579637761">September 29, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>冠詞がないとご指摘頂きました。</p>

<blockquote class="twitter-tweet" lang="en"><p>React.jsについてのスライド書いた <a href="https://t.co/AxCEVstmfb">https://t.co/AxCEVstmfb</a> <a href="https://twitter.com/hashtag/reactjs?src=hash">#reactjs</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/516812116783661056">September 30, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>React.jsについてまとめてる。</p>

<blockquote class="twitter-tweet" lang="en"><p>中学英語〜みたいな本読んだら前より英語わかるようになったのでどうやら中学レベルの英語力らしい。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/519309644871630848">October 7, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>中学レベルの英語力です。</p>

<blockquote class="twitter-tweet" lang="en"><p>雑にVue.js v0.11での変更点まとめた(個人のメモレベル) 「Vue.js v0.11の変更点(予定)まとめ」 <a href="http://t.co/OSu4sTayFa">http://t.co/OSu4sTayFa</a> <a href="https://twitter.com/hashtag/vuejs?src=hash">#vuejs</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/519371264226373633">October 7, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>個人のメモレベルって書いてるのは逃げですね。</p>

<blockquote class="twitter-tweet" lang="en"><p>そっか、podcastもscrobblingされるのか <a href="http://t.co/Gy4GgRhP8I">pic.twitter.com/Gy4GgRhP8I</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/519661300113080322">October 8, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>BeckとNUMBER GIRLの間にmiyagawaさんがいる。</p>

<blockquote class="twitter-tweet" lang="en"><p>ヨセミテった</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/523022191332323330">October 17, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>ヨセミテにしたらしい。</p>

<blockquote class="twitter-tweet" lang="en"><p>What is song used by JavaScript Jabber?</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/524365178595311616">October 21, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>JavaScript Jabberの曲が気になっている。これも冠詞ないな&hellip;。</p>

<blockquote class="twitter-tweet" lang="en"><p>家族増えると帰省するだけでめっちゃお金掛かるようになる</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/524462349533446146">October 21, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>知見です。</p>

<blockquote class="twitter-tweet" lang="en"><p>koaのworkshopやったついでにtypoとか直しておいた。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/524766543591112704">October 22, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>何故かこのタイミングでkoaのworkshopやってた。</p>

<blockquote class="twitter-tweet" lang="en"><p>JSONをサーバーとフロント側で安全に共有する on <a href="https://twitter.com/Qiita">@Qiita</a> <a href="http://t.co/hzJHzaU7m0">http://t.co/hzJHzaU7m0</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/525185306249539584">October 23, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>結構XSS出来そうなサンプル実装が多かったので書いてみた。</p>

<blockquote class="twitter-tweet" lang="en"><p>達人出版会さん、kindleフォーマットも欲しいです…。変換するの面倒なので…。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/525666150500151297">October 24, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>お願いします&hellip;。</p>

<blockquote class="twitter-tweet" lang="en"><p>現状です。 &quot;Joining TOLOT&quot; <a href="http://t.co/8udQFUqVs0">http://t.co/8udQFUqVs0</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/531595354605514752">November 9, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>転職したようです。</p>

<blockquote class="twitter-tweet" lang="en"><p>めっちゃAWSのドキュメント読んでる</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/531726245336084480">November 10, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>AWSについて調べているみたいです。</p>

<blockquote class="twitter-tweet" lang="en"><p>知らないことに囲まれて、hubotのscript書くことに逃避しかけてた。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/531752267557244928">November 10, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twipt async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>逃避です。</p>

<blockquote class="twitter-tweet" lang="en"><p>JSのテスト、mochaとpower-assertでファイナルアンサー感ある。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/532529669262675970">November 12, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>この組み合わせはいいと思う。</p>

<blockquote class="twitter-tweet" lang="en"><p>とりあえずVDOMとJavaScriptのAdventCalendarには登録しておいた</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/532690253459378176">November 13, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Advent Calendar、この時はReact.jsの書くかまだ悩んでた。</p>

<blockquote class="twitter-tweet" lang="en"><p>Om試さないとな</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/534370157565460480">November 17, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Omは来年触る。(多分&hellip;)</p>

<blockquote class="twitter-tweet" lang="en"><p>React.jsのAdventCalendar書くぞ！！！ <a href="http://t.co/z8ecrLvoSx">http://t.co/z8ecrLvoSx</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/537979299244937216">November 27, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>勢い大事。</p>

<blockquote class="twitter-tweet" lang="en"><p>Reactのドキュメント読んでたら間違ってたので直しておいた</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/539554749603803137">December 1, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>documentのfixだけど、contributeしておいた。</p>

<blockquote class="twitter-tweet" lang="en"><p>Utilsとかって名前、負けてる感あって好きじゃないんだよなー。実際のprojectに作るとなんでもそこに入ってくるし。</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/541852742822543361">December 8, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Util問題。(これは多分Fluxの実装見て言ってる)</p>

<blockquote class="twitter-tweet" lang="en"><p>子連れのAdventCalendar書いておいた</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/542703997685997568">December 10, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>React.jsのAdvent Calendarの息抜きに書いた。</p>

<blockquote class="twitter-tweet" lang="en"><p>.<a href="https://twitter.com/ama_ch">@ama_ch</a> コメント書きました！ <a href="https://t.co/1OAwiHkOdt">https://t.co/1OAwiHkOdt</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/545241754752909312">December 17, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>呼ばれたので答えた。</p>

<blockquote class="twitter-tweet" lang="en"><p>The Get Up Kidsはエモい</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/545837308503543809">December 19, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>エモい is&hellip;</p>

<blockquote class="twitter-tweet" lang="en"><p>私のJavaScript情報の集め方 on <a href="https://twitter.com/Qiita">@Qiita</a> <a href="http://t.co/UoRg6MHPIh">http://t.co/UoRg6MHPIh</a></p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/547248396835123201">December 23, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>さくっと書いたら意外とストックされた。</p>

<blockquote class="twitter-tweet" lang="en"><p>React.js Advent Calendar全部のストック数とさくっと書いた情報の集め方1つの記事のストック数がほぼ同じという現実…</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/547914405963247617">December 25, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>これな。</p>

<blockquote class="twitter-tweet" lang="en"><p>一人React.js Advent Calendarお疲れ様でした！</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/547989651219152898">December 25, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>他のAdvent Calendarで言ってたら一人だけど言ったら意外と反応もらえて嬉しかった。</p>

<blockquote class="twitter-tweet" lang="en"><p>来年 <a href="https://twitter.com/hashtag/reactsushi?src=hash">#reactsushi</a> いくぞ！！</p>&mdash; Toru Kobayashi (@koba04) <a href="https://twitter.com/koba04/status/548023404238880768">December 25, 2014</a></blockquote>


<script async src="http://blog.koba04.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>いくぞ！</p>

<hr />

<p>良いお年を。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Joining TOLOT]]></title>
    <link href="http://blog.koba04.com/post/2014/11/08/joining-tolot/"/>
    <updated>2014-11-08T23:19:00+09:00</updated>
    <id>http://blog.koba04.com/post/2014/11/08/joining-tolot</id>
    <content type="html"><![CDATA[<p>11月から<a href="http://tolot.com/">TOLOT</a>で働いています。</p>

<p><a href="http://tolot.com/">http://tolot.com/</a></p>

<!-- more -->


<p>TOLOTは500円でフォトブックやカレンダーが作れるサービスで、1ユーザーとして好きなサービスだし中の人に話を聞いたりしてこれから面白くなっていきそうだなと思ったので決めた感じです。</p>

<p>振り返ってみると高校の時にUS/UK RockのMix-CDを作ってあげたりするのが好きで、モノを作って自分を含む誰かにプレゼントすることが簡単に出来るサービスに対する思い入れが強いというのも背景にあったりします。</p>

<p>今のところしばらくはサーバーサイドを中心にやる感じかなと思っていますが、そのうちフロントエンドとかAPI設計とか<a href="http://www.oreilly.co.jp/books/9784873116761/">ハイパフォーマンスブラウザネットワーキング</a>に書いてあるようなこととかを駆使してWebで面白いことやりたいなと思っています。</p>

<p>まだ1週間ですが、技術的にも面白い人たちと一緒働けて楽しいです。</p>

<p>色んな言語の色んなシステムがあって、やりたいこともいっぱいあるので興味ある人は是非声掛けてください！</p>

<p>さて、来年のカレンダーもそろそろ作らないと。</p>

<hr />

<p><a href="http://www.amazon.co.jp/registry/wishlist/3RM30V69LJHUY">例のやつ</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[vueifyでcomponent化]]></title>
    <link href="http://blog.koba04.com/post/2014/10/07/component-by-vueify/"/>
    <updated>2014-10-07T15:29:06+09:00</updated>
    <id>http://blog.koba04.com/post/2014/10/07/component-by-vueify</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/vuejs/vueify">https://github.com/vuejs/vueify</a></p>

<p>vueifyというVue.js用のbrowserifyのtransformが出てたので紹介。</p>

<!-- more -->


<p>以前にpartialifyやstylify、coffeeify、insert-cssなどを組み合わせてHTML、JavaScript、CSSをComponent化する方法を紹介しましたがそれをさらに進めて1つのファイルで完結することが出来るようになっています。</p>

<p><a href="http://blog.koba04.com/post/2014/04/17/reusable-components-by-vuejs-and-browserify/">http://blog.koba04.com/post/2014/04/17/reusable-components-by-vuejs-and-browserify/</a></p>

<h2>使い方</h2>

<p>vueifyを使うと1つのファイルにHTMLとJavaScriptとCSSを全部まとめて書くようになり、1ファイルが1Componentという形になります。</p>

<ul>
<li>src/app.vue</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;script lang="coffee"&gt;
</span><span class='line'>  module.exports =
</span><span class='line'>    data: -&gt;
</span><span class='line'>      view: "top"
</span><span class='line'>&lt;/script&gt;
</span><span class='line'>
</span><span class='line'>&lt;template&gt;
</span><span class='line'>  &lt;div v-component="" v-transition&gt;&lt;/div&gt;
</span><span class='line'>&lt;/template&gt;
</span><span class='line'>
</span><span class='line'>&lt;style lang="stylus"&gt;
</span><span class='line'>  #app
</span><span class='line'>    .v-enter
</span><span class='line'>      -webkit-animation: fadein 0.5s
</span><span class='line'>      -webkit-animation-delay: 0.2s
</span><span class='line'>      animation: fadein 0.5s
</span><span class='line'>      animation-delay: 0.2s
</span><span class='line'>      opacity: 0
</span><span class='line'>    .v-leave
</span><span class='line'>      -webkit-animation: fadeout 0.2s
</span><span class='line'>      animation: fadeout 0.2s
</span><span class='line'>
</span><span class='line'>  @keyframes fadein
</span><span class='line'>    0%
</span><span class='line'>      transform: scale(0.5)
</span><span class='line'>      -webkit-transform: scale(0.5)
</span><span class='line'>      opacity: 0
</span><span class='line'>    50%
</span><span class='line'>      transform: scale(1.2)
</span><span class='line'>      -webkit-transform: scale(1.2)
</span><span class='line'>      opacity: 0.7
</span><span class='line'>    100%
</span><span class='line'>      transform: scale(1)
</span><span class='line'>      -webkit-transform: scale(1)
</span><span class='line'>      opacity: 1
</span><span class='line'>
</span><span class='line'>  @keyframes fadeout
</span><span class='line'>    0%
</span><span class='line'>      transform: scale(1)
</span><span class='line'>      -webkit-transform: scale(1)
</span><span class='line'>    100%
</span><span class='line'>      transform: scale(0)
</span><span class='line'>      -webkit-transform: scale(0)
</span><span class='line'>&lt;/style&gt;</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>➜  tree src
</span><span class='line'>src
</span><span class='line'>├── app.vue
</span><span class='line'>├── artist.vue
</span><span class='line'>├── country.vue
</span><span class='line'>├── footer.vue
</span><span class='line'>├── index.js
</span><span class='line'>├── input-artist.vue
</span><span class='line'>├── nav.vue
</span><span class='line'>├── select-country.vue
</span><span class='line'>├── top.vue
</span><span class='line'>└── tracks.vue</span></code></pre></td></tr></table></div></figure>


<p><a href="https://github.com/koba04/vue-boilerplate/tree/master/src">https://github.com/koba04/vue-boilerplate/tree/master/src</a></p>

<p>coffeescriptとstylus以外にも、less、scss(node-sass)、jadeなどを指定することが出来ます。</p>

<h2>syntax highlight</h2>

<p>1つにまとめて、vueっていう拡張子付けたりするとシンタックスハイライトどうするのかという問題になりますが、SublimeTextだとこれで大丈夫なようです
(使ってないのでわからないですが)</p>

<p><a href="https://gist.github.com/yyx990803/9194f92d96546cebd033">https://gist.github.com/yyx990803/9194f92d96546cebd033</a></p>

<p>vimとかの場合は&hellip;</p>

<p>まぁ、ちょっとしたものを作るときにvueify使ってみるのもいいのではないでしょうか。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vue.js v0.11の変更点(予定)まとめ]]></title>
    <link href="http://blog.koba04.com/post/2014/10/07/vue-js-v011-changes/"/>
    <updated>2014-10-07T13:04:51+09:00</updated>
    <id>http://blog.koba04.com/post/2014/10/07/vue-js-v011-changes</id>
    <content type="html"><![CDATA[<p>Vue.js v0.11のrc版もリリースされて、v0.10からの変更点が多いのでchangesを参考にまとめてみました。</p>

<p><strong> rc3がリリースされたので修正・追記しました </strong></p>

<p>APIの変更も多いですが、data継承の仕組みが完全に変わっているのでその辺りは注意が必要ですね。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install vue@0.11.0-rc2</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<p>まだ安定してなかったりドキュメントはv0.10のものしかなくてchangesとmergeしながら読む必要があったりするので、これから開発する人は今のタイミングはどのバージョンを使えばいいのかちょっと悩ましいですね。v0.11系を使っていった方がいいとは思いつつ。</p>

<p>今回の変更でも見えるのですが、Angular.js以外にもBackbone.jsやReact.jsなど様々なフレームワークからいいところを持ってきてるところがVue.jsの面白いところですね。</p>

<p><a href="https://github.com/yyx990803/vue/blob/0.11.0-rc3/changes.md">https://github.com/yyx990803/vue/blob/0.11.0-rc3/changes.md</a></p>

<h2>Instantiation process</h2>

<p><code>el</code>オプションがインスタンス化する際に指定されていなかった場合、以前は空のdivを作成していましたが&#8221;unmounted&#8221;な状態となり新しく追加された<code>$mount</code>メソッドにquerySelectorを渡すことでViewと紐付けるようになりました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span> <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="mi">1</span><span class="p">}</span> <span class="p">})</span> <span class="c1">// only observes the data</span>
</span><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">$mount</span><span class="p">(</span><span class="s1">&#39;#app&#39;</span><span class="p">)</span> <span class="c1">// actually compile the DOM</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// in comparison, this will compile instantly just like before.</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span> <span class="nx">el</span><span class="o">:</span> <span class="s1">&#39;#app&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">}</span> <span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>$mount()</code>を引数なしで呼ぶと空の<code>&lt;div&gt;</code>が作成されます。</li>
</ul>


<h2>New Scope Inheritance Model</h2>

<p>以前のバージョンではprototypeなデータ継承の仕組みを持っていませんでした。にも関わらず<code>this.$parent</code>や<code>this.$get</code>を使って親scopeの値を参照することが出来ました。</p>

<p>新しいバージョンでは、Angular.jsに似た継承システムを持っていて、直接親scopeの値を参照することが出来ます。
大きな違いは子scopeで値を設定するとそれは親scopeにも影響することです。</p>

<p>この例がわかりやすいです。 <a href="http://jsfiddle.net/Px2n6/2/">http://jsfiddle.net/Px2n6/2/</a></p>

<p>デフォルトではtemplate内で入れ子にしても親scopeは継承しません。これは意図せず親scopeの値を書き換えないようにするためです。
もし親scopeを継承したい場合は<code>inherit: true</code>オプションをつける必要があります。</p>

<p><code>v-repeat</code>と<code>v-if</code>は親scopeをデフォルトで継承します。</p>

<h2>Instance Option changes</h2>

<h3><code>Vue.extend</code>内で<code>el</code>と<code>data</code>を使用する場合は関数定義にする必要があります。</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">MyComponent</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">el</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">// you can initialize your element here.</span>
</span><span class='line'>    <span class="c1">// you can even return a documentFragment to create</span>
</span><span class='line'>    <span class="c1">// a block instance.</span>
</span><span class='line'>    <span class="nx">el</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;content&#39;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">el</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">data</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// similar to ReactComponent.getInitialState</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">a</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">b</span><span class="o">:</span> <span class="mi">123</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>events</code>オプション追加されました</h3>

<p>Backbone.jsのeventsみたいな感じですね。
$emitで発行する独自イベント以外にも<code>hook:created</code>のようなライフサイクルイベントについても定義することが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="s1">&#39;hook:created&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;created!&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">greeting</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="c1">// can also use a string for methods</span>
</span><span class='line'>    <span class="nx">bye</span><span class="o">:</span> <span class="s1">&#39;sayGoodbye&#39;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">sayGoodbye</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;goodbye!&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="c1">// -&gt; created!</span>
</span><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">&#39;greeting&#39;</span><span class="p">,</span> <span class="s1">&#39;hi!&#39;</span><span class="p">)</span>
</span><span class='line'><span class="c1">// -&gt; hi!</span>
</span><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">&#39;bye&#39;</span><span class="p">)</span>
</span><span class='line'><span class="c1">// -&gt; goodbye!</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>watch</code>オプションが追加されました</h3>

<p><code>events</code>のようにwatchしたい対象の評価式とコールバックをオブジェクトの形式で定義することが出来ます。
わかりやすく書けるようになっていいですね。</p>

<h3><code>inherit</code>オプションが追加されました(デフォルトはfalse)</h3>

<p>親scopeの<code>data</code>を継承するかどうかの設定です。
継承することで</p>

<ol>
<li>親scopeの値をtemplateで参照することが出来るようになります</li>
<li>親scopeの値をインスタンスから直接アクセス出来るようになります</li>
</ol>


<h3><code>mixin</code>オプションが追加されました</h3>

<p>いわゆるmixinってやつです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">mixin</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">created</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">created</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">},</span>
</span><span class='line'>  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">mixin</span><span class="p">]</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="c1">// -&gt; 1</span>
</span><span class='line'><span class="c1">// -&gt; 2</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>name</code>オプションが追加されました</h3>

<p>デバッグしやすさのために名前をつけることが出来るようになりました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">SubClass</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;MyComponent&#39;</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SubClass</span><span class="p">()</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">instance</span><span class="p">)</span> <span class="c1">// -&gt; MyComponent { $el: ... }</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>parent</code>オプションが削除されました</h3>

<p>かわりに$addChildを使うことが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">$addChild</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="p">[</span><span class="nx">contructor</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>lazy</code>が削除されました</h3>

<p>ViewModelに指定するのではなくて、<code>v-model</code>毎に設定すべきだからということで<code>v-model</code>のoptionになりました。</p>

<h3><code>id</code>、<code>tagName</code>、<code>className</code>、<code>attributes</code>も削除されました</h3>

<p>代わりに<code>el</code>に関数定義して指定するようにします</p>

<h3><code>created</code>のhookの挙動が変更されました</h3>

<p>データバインディングされた後に呼ばれるにようになったので、dataを追加する場合は$addや$removeを使わないとデータバインディングの対象にならなくなりました。</p>

<h3><code>ready</code>のhookの挙動が変更されました</h3>

<p>documentに初めて追加されるときだけに呼ばれるようになりました。これまでと同じように使いたい場合は<code>compiled</code>を使ってください。</p>

<h3><code>beforeCompile</code>のhookが追加されました</h3>

<p>インスタンス化されてDOMのcompileが開始される前に呼ばれます。</p>

<h3><code>compiled</code>のhookが追加されました</h3>

<p>これまでの<code>ready</code>のタイミングで呼ばれて、初期のデータでのcompileが終了したタイミングで呼ばれます。</p>

<h3><code>afterDestroy</code>のhookが<code>destroy</code>に変更されました</h3>

<h2>Instance methods change</h2>

<h3><code>$watch</code>に評価式を渡せるようになりました</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;a + b&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">newVal</span><span class="p">,</span> <span class="nx">oldVal</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// do something</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>$watch</code>でのdeep watchの挙動が変わりました</h3>

<p>デフォルトではwatchに渡した値に対する変更しか監視しなくなったので、ネストしたオブジェクトの評価をしたい場合は、第三引数に<code>true</code>を渡す必要があります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;someObject&#39;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
</span><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">someObject</span><span class="p">.</span><span class="nx">nestedValue</span> <span class="o">=</span> <span class="mi">123</span>
</span><span class='line'><span class="c1">// callback is fired</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>$watch</code>の即時実行</h3>

<p>第四引数にtrueを渡すことで初回に値をセットするときにもcallbackを実行させることが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
</span><span class='line'><span class="c1">// callback is fired immediately with current value of `a`</span>
</span></code></pre></td></tr></table></div></figure>


<p>この辺、deepWatchと合わせて第三引数をoptionsなオブジェクトにしたほうがいいと思う。</p>

<h3><code>$unwatch</code>は削除されて、<code>$watch</code>の戻り値である関数を呼ぶことでunwatchされます</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">unwatch</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span>
</span><span class='line'><span class="c1">// later, teardown the watcher</span>
</span><span class='line'><span class="nx">unwatch</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>vm.$get</code>に評価式を渡せるようになりました</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$get</span><span class="p">(</span><span class="s1">&#39;a + b&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>vm.$add</code>と<code>vm.$delete</code>が追加されました</h3>

<p>ViewModelのプロパティを追加・削除するときに使います。
まぁでも、インスタンス化する際に全てのプロパティをnullなどで設定しておく方がいいです。</p>

<h3><code>vm.$eval</code>が追加されました</h3>

<p>filterも適用することが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="s1">&#39;msg | uppercase&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>vm.$interpolate</code>が追加されました</h3>

<p>template文字列を評価することが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">markup</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">$interpolate</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;&lt;/p&gt;&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>vm.$log</code>が追加されました</h3>

<p>インスタンスのdataを生のオブジェクトとしてみることが出来ます(getter/setterなし)。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">$log</span><span class="p">()</span> <span class="c1">// logs entire ViewModel data</span>
</span><span class='line'><span class="nx">vm</span><span class="p">.</span><span class="nx">$log</span><span class="p">(</span><span class="s1">&#39;item&#39;</span><span class="p">)</span> <span class="c1">// logs vm.item</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>vm.$compile</code>が追加されました</h3>

<p>DOMをcompileすることが出来て、戻り値としてteardownするときに使うdecompileする関数を返します。
decompile関数ではDOMは削除されません。
主にカスタムdirectiveを書く人のためのメソッドです。</p>

<h2>Computed Properties API Change</h2>

<h3><code>$get</code>、<code>$set</code>は<code>get</code>、<code>set</code>になりました</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">computed</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">fullName</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{},</span>
</span><span class='line'>    <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Directive API change</h2>

<h3>directiveに動的な値を指定出来るようになりました</h3>

<p>こんな感じでv-viewみたいなことが出来るようになりました</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">v-component=</span><span class="s">&quot;{{test}}&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>今サポートしているのは<code>v-component</code>だけで、独自directiveを作る時は<code>update</code>関数を実装することでハンドリング出来ます。</p>

<h3><code>v-model</code>に<code>lazy</code>属性と<code>number</code>属性が追加されました</h3>

<p><code>lazy</code>はこれまでインスタンスオプションにあった、enterキー押したときかフォーカス外れた時だけにchangeイベントが発行されるものがv-modelの属性になりました。</p>

<p><code>number</code>はmodelに反映されるときにNumber型にすることが出来ます。</p>

<h3>select要素に<code>v-model</code>としてtextとvalueを含んだオブジェクトの配列を渡すとoption要素として評価してくれます</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">[</span>
</span><span class='line'>  <span class="p">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;a&#39;</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;b&#39;</span> <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;select&gt;</span>
</span><span class='line'>  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;a&quot;</span><span class="nt">&gt;</span>A<span class="nt">&lt;/option&gt;</span>
</span><span class='line'>  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;b&quot;</span><span class="nt">&gt;</span>B<span class="nt">&lt;/option&gt;</span>
</span><span class='line'><span class="nt">&lt;/select&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>select要素に<code>v-model</code>としてlabelとoptionsを含んだオブジェクトの配列を渡すとoptgroup要素として評価してくれます</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">[</span>
</span><span class='line'>  <span class="p">{</span> <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]},</span>
</span><span class='line'>  <span class="p">{</span> <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;select&gt;</span>
</span><span class='line'>  <span class="nt">&lt;optgroup</span> <span class="na">label=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;a&quot;</span><span class="nt">&gt;</span>a<span class="nt">&lt;/option&gt;</span>
</span><span class='line'>    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;b&quot;</span><span class="nt">&gt;</span>b<span class="nt">&lt;/option&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/optgroup&gt;</span>
</span><span class='line'>  <span class="nt">&lt;optgroup</span> <span class="na">label=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;c&quot;</span><span class="nt">&gt;</span>c<span class="nt">&lt;/option&gt;</span>
</span><span class='line'>    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">&quot;d&quot;</span><span class="nt">&gt;</span>d<span class="nt">&lt;/option&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/optgroup&gt;</span>
</span><span class='line'><span class="nt">&lt;/select&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>v-component</code>に<code>keep-alive</code>属性を指定するとインスタンスを破棄せずにキャッシュしておいてくれるようになります</h3>

<p>Viewの切り替えを<code>v-component</code>で行うときに使うとよさそうです。使い方間違うとリークしそうですが&hellip;。</p>

<h3><code>v-repeat</code>に<code>trackby</code>を指定することで、配列の値を再利用することが出来るようになりました</h3>

<p>配列のdataにAPIのレスポンスなどを適用してswapされた場合など、今までは全部の要素を作りなおしていたのですがtrackbyを指定することで既存の値は再利用してくれるようになりました。React.jsのkeyみたいな感じ。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">items</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>  <span class="p">{</span> <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="p">...</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="p">...</span> <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span> <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="p">...</span> <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;li</span> <span class="na">v-repeat=</span><span class="s">&quot;items&quot;</span> <span class="na">trackby=</span><span class="s">&quot;_id&quot;</span><span class="nt">&gt;</span>...<span class="nt">&lt;/li&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>v-with</code>で親と子のインスタンスの間で2wayバインディングされないようになりました</h3>

<p><code>v-with</code>で作られた子のインスタンスの値を変更しても親には反映されなくなります。親のインスタンスの変更は子に反映されます。</p>

<h3><code>v-el</code>が追加されました</h3>

<p><code>v-ref</code>で似た感じですが、こちらは<code>vm.$$.xxx</code>とすることでDOM Nodeを参照することが出来ます。</p>

<h3><code>twoWay</code>のオプションが追加されました</h3>

<p>このオプションはdirectiveが2wayデータバインディングをするかどうかを指定します。
これを指定することで<code>this.set(value)</code>をdirectiveの内部で使用することが出来ます。</p>

<ul>
<li>ちょっとどういう使われ方するのかよくわかってないです&hellip;</li>
</ul>


<h3><code>acceptStatement</code>のオプションが追加されました</h3>

<p>このオプションはdirectiveが<code>v-on</code>のようにインラインステートメントを受け付けるかどうかを指定します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;a</span> <span class="na">v-on=</span><span class="s">&quot;click: a++&quot;</span><span class="nt">&gt;&lt;/a&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>指定したステートメントは関数としてラップされてdirectiveの<code>update</code>関数に渡されます。</p>

<h3><code>isEmpty</code>と<code>isFn</code>オプションが削除されました</h3>

<h2>Interpolation change</h2>

<h3>textのバインディング自動的にstringifyしなくなりました。</h3>

<p><code>json</code>filterを使いましょう。</p>

<h3>One time interpolationsが指定出来るようになりました</h3>

<p>変更されない値に指定することでrenderingのパフォーマンスを向上させることが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;span&gt;</span>{{* hello }}<span class="nt">&lt;/span&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Config API change</h2>

<h3>Vue.configがメソッド形式からpropertyアクセスに変更されました</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// old</span>
</span><span class='line'><span class="c1">// Vue.config(&#39;debug&#39;, true)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// new</span>
</span><span class='line'><span class="nx">Vue</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">debug</span> <span class="o">=</span> <span class="kc">true</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>config.prefix</code>の値にハイフンが必須になりました</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">Vue</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">prefix</span> <span class="o">=</span> <span class="s2">&quot;data-&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>config.delimiters</code>が少し柔軟に指定出来るようになりました</h3>

<p>これまでは<code>['{','}']</code>というような指定しか出来なかったのが<code>['(%', '%)']</code>という指定も出来るようになりました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">Vue</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">delimiters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(%&#39;</span><span class="p">,</span> <span class="s1">&#39;%)&#39;</span><span class="p">]</span>
</span><span class='line'><span class="c1">// tags now are (% %) for text</span>
</span><span class='line'><span class="c1">// and ((% %)) for HTML</span>
</span></code></pre></td></tr></table></div></figure>


<h3>&lsquo;proto&#8217;optionをfalseにすることでArrayの<code>__proto__</code>の書き換えを禁止することが出来ます</h3>

<p>NativeのArrayのsubclassなどを作っている場合で、<code>__proto__</code>の書き換えされると困る場合にfalseにすることで<code>__proto__</code>の書き換えがされなくなります
(配列のオブジェクトに追加される)</p>

<p><img src="http://blog.koba04.com/images/vue-config-proto.png" title="'Vue.config.proto = false'" ></p>

<p>またrc2からオブジェクトの場合に<code>__proto__</code>の書き換えがされることはなくなりました。ただObject.prototypeに$addと$delete、Array.prototypeに$removeと$setが追加されています。</p>

<p>dataに生のオブジェクトを使っている場合には影響無いですが、Constructorから作ったオブジェクトを使っている場合にはprototypeが残るようになります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">Hoge</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="nx">Hoge</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://blog.koba04.com/images/vue-object-prototype.png" title="'Vue object prototype'" ></p>

<h3>async optionをfalseにすることで即時にDOMが更新することが出来ます</h3>

<p>通常は、batch方式によってDOMの更新はまとめて行われるのですが、このオプションをfalseにすることで即時にDOMに反映することが出来るようになります。</p>

<p><strong>当初は「trueにすると」と書いていたので修正しました(2015/02/26)</strong></p>

<h2>Transition API change</h2>

<h3><code>v-transition</code>と<code>v-animation</code>と<code>v-effect</code>の違いはなくなりました</h3>

<p>どれかに統一されるのかな？</p>

<h3><code>Vue.config</code>でenter/leaveの指定が設定出来なくなりました</h3>

<h3><code>Vue.effect</code>は<code>Vue.transition</code>に変更されました。<code>effects</code>オプションも<code>transitions</code>に変更されました。</h3>

<h3><code>v-transition="my-transition"</code>とした場合、</h3>

<ol>
<li><code>Vue.transition(id, def)</code>で登録されているオブジェクトまたは、<code>transitions</code>オプションを&#8221;my-transition&#8221;をkeyとして探します。</li>
<li>上記で見つからなかった場合、CSS transitionsまたはCSS animationsを適用します。</li>
<li>上記でもアニメーションしなかった場合、DOM操作を即時に行われます。</li>
</ol>


<h3>JavaScript transitionsのAPIがAngular.jsっぽく変更されました</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">Vue</span><span class="p">.</span><span class="nx">transition</span><span class="p">(</span><span class="s1">&#39;fade&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">beforeEnter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// a synchronous function called right before the</span>
</span><span class='line'>    <span class="c1">// element is inserted into the document.</span>
</span><span class='line'>    <span class="c1">// you can do some pre-styling here to avoid FOC.</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">enter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// element is already inserted into the DOM</span>
</span><span class='line'>    <span class="c1">// call done when animation finishes.</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>      <span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;opacity&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">.</span><span class="nx">animate</span><span class="p">({</span> <span class="nx">opacity</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="mi">1000</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">// optionally return a &quot;cancel&quot; function</span>
</span><span class='line'>    <span class="c1">// to clean up if the animation is cancelled</span>
</span><span class='line'>    <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">stop</span><span class="p">()</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">leave</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// same as enter</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span>
</span><span class='line'>      <span class="p">.</span><span class="nx">animate</span><span class="p">({</span> <span class="nx">opacity</span><span class="o">:</span> <span class="mi">0</span> <span class="p">},</span> <span class="mi">1000</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">stop</span><span class="p">()</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Events API change</h2>

<h3><code>$dispatch</code>と<code>broadcast</code>で発行されるイベントのコールバックでfalseを返すと、伝播を止めることが出来るようになりました。</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">()</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">parent</span><span class="o">:</span> <span class="nx">a</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">parent</span><span class="o">:</span> <span class="nx">b</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'>
</span><span class='line'><span class="nx">a</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="nx">b</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="kc">false</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="nx">c</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="nx">c</span><span class="p">.</span><span class="nx">$dispatch</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</span><span class='line'><span class="c1">// -&gt; &#39;c&#39;</span>
</span><span class='line'><span class="c1">// -&gt; &#39;b&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Two Way filters</h2>

<h3>filterに関数を渡すとreadのfilterとして扱われますが、<code>v-model</code>のような2wayバインディングのdirectiveと組み合わせることでwriteのfilterも定義出来るようになりました</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">Vue</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="s1">&#39;format&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">read</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">val</span> <span class="o">+</span> <span class="s1">&#39;!&#39;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">write</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">oldVal</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">val</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/ok/</span><span class="p">)</span> <span class="o">?</span> <span class="nx">val</span> <span class="o">:</span> <span class="nx">oldVal</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Block logic control</h2>

<h3>template要素を制御ブロックとして扱うことが出来るようになりました</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">items</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;title-1&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">subtitle</span><span class="o">:</span> <span class="s1">&#39;subtitle-1&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">content</span><span class="o">:</span> <span class="s1">&#39;content-1&#39;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;title-2&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">subtitle</span><span class="o">:</span> <span class="s1">&#39;subtitle-2&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">content</span><span class="o">:</span> <span class="s1">&#39;content-2&#39;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">v-repeat=</span><span class="s">&quot;item:items&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h2&gt;</span><span class="nt">&lt;/h2&gt;</span>
</span><span class='line'>  <span class="nt">&lt;p&gt;</span><span class="nt">&lt;/p&gt;</span>
</span><span class='line'>  <span class="nt">&lt;p&gt;</span><span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="c">&lt;!--v-block-start--&gt;</span>
</span><span class='line'><span class="nt">&lt;h2&gt;</span>title-1<span class="nt">&lt;/h2&gt;</span>
</span><span class='line'><span class="nt">&lt;p&gt;</span>subtitle-1<span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;p&gt;</span>content-1<span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="c">&lt;!--v-block-end--&gt;</span>
</span><span class='line'><span class="c">&lt;!--v-block-start--&gt;</span>
</span><span class='line'><span class="nt">&lt;h2&gt;</span>title-2<span class="nt">&lt;/h2&gt;</span>
</span><span class='line'><span class="nt">&lt;p&gt;</span>subtitle-2<span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="nt">&lt;p&gt;</span>content-2<span class="nt">&lt;/p&gt;</span>
</span><span class='line'><span class="c">&lt;!--v-block-end--&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>v-partial</code>にtemplateと一緒に使うことが出来ますし、下記のようにすることでpartialを動的に選択することが出来ます</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">v-partial=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Misc</h2>

<h3><code>$destroy()</code>はdefaultだと<code>$el</code>はそのまま残すので、<code>$el</code>も削除したい場合は<code>$destroy(true)</code>としてください</h3>

<h3><code>v-model</code>と一緒に<code>value</code>属性を指定するとvmの値を上書きして初期値として設定されます</h3>

<hr />

<p>vue.js bookもv0.11対応して続きを書かないと&hellip;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[YAPC::ASIA 2014の前夜祭をやった]]></title>
    <link href="http://blog.koba04.com/post/2014/08/30/hold-yapc-asia-2014-eve/"/>
    <updated>2014-08-30T01:30:49+09:00</updated>
    <id>http://blog.koba04.com/post/2014/08/30/hold-yapc-asia-2014-eve</id>
    <content type="html"><![CDATA[<p><a href="http://yapcasia.org/2014/talk/show/bc6052f4-0c8b-11e4-aec0-ad686aeab6a4">http://yapcasia.org/2014/talk/show/bc6052f4-0c8b-11e4-aec0-ad686aeab6a4</a></p>

<p>YAPC::ASIA 2014の前夜祭の企画・進行をやってきました。</p>

<p><a href="http://gihyo.jp/news/report/01/yapcasia2014/0000">http://gihyo.jp/news/report/01/yapcasia2014/0000</a></p>

<!-- more -->


<h2>突然のオファー</h2>

<p>そもそも何でやっていたかですが、</p>

<p><a href="https://twitter.com/yusukebe">@yusukebe</a>さんからWebアプリのコンテストみたいなのやりたいから企画と当日の仕切りをお願いしますというオファーが来たので、なんか大変そうな気もするけど楽しそうなので受けることにしました。</p>

<h2>企画を考える</h2>

<p>結局、10minのTalkを10本ぶっ続けという形式に落ち着きましたが、@yusukebeさんの他にも<a href="https://twitter.com/uzulla">@uzulla</a>さん、<a href="https://twitter.com/kfly8">@kfly8</a>さんと相談しながらかなり悩んでいました。</p>

<ul>
<li>投票形式にする？</li>
<li>LT(5min)にする？</li>
<li>パネルディスカッションにする？</li>
<li>一般募集する？</li>
<li>:</li>
</ul>


<p>ですが最終的には、「前夜祭はYAPC::ASIA 2014一番目のイベント」なので勢いのある感じにしたいということで、Talk(10min)を10本ぶっ通しで行うという形に落ち着きました。</p>

<p>なんとなく、今回はYAPC初参加のPerlを使っていない人もそこそこいると思ったのと、前夜祭は初参加の人にとってはYAPCを印象付けるものになると思ったので、誰でも楽しめるようなイベントになるようにとは考えていました。</p>

<h2>オファーする</h2>

<p>誰にオファーするかは、一度上記のメンバーで集まった時にひたすら面白いサービス作っている人の名前を挙げていって、そのリストから自分が聞きたい！と思った人に順番に声を掛けていきました。(一応PerlメインになりそうなTalkのバランスも考えましたが)</p>

<p><img src="http://blog.koba04.com/images/oretoku.png"></p>

<p>皆さん快くお受け頂いて本当に感謝しています。</p>

<h2>そして当日</h2>

<p>司会とタイムキーパーをやっていたので100%聞けていたわけではないですが、全部のTalkが面白くて3分前と1分前に出していた案内が遅れることも&hellip;。</p>

<p>準備不足で若干もたついたところもあり申し訳なかったです&hellip;。</p>

<h3>@__papix__ / GeekDojo</h3>

<p>Pamon2という独自にAmon2を拡張したライブラリを使っていたり、チームでの開発での話も聞けそうで面白そうだなと思いお願いしました。</p>

<p>一発目のTalkでしたがさすがの盛り上げっぷりでPerlの話もありつつ楽しませてもらいました。</p>

<h3>@hondallica / hrhm.info</h3>

<p>Heavymetal好きのためのサービスということでかなり濃いこだわりが聞けるのではないかなと思いお願いしました。</p>

<p>Talkが本当に面白くてHeavymetalに対する愛が詰まった発表で素晴らしかったです。</p>

<h3>@ppworks / pplog</h3>

<p>この企画を考えた際にまず思いついたのが個人的にも好きなサービスであるpplogで、下記のエントリを見て話を聞きたいなと思いお願いしました。</p>

<ul>
<li><a href="http://ppworks.hatenablog.jp/entry/2014/07/13/012855">http://ppworks.hatenablog.jp/entry/2014/07/13/012855</a></li>
</ul>


<p>自分たちが使いたいものを作るというはっきりとした意思があり、それをPOEMとして文章にしておくなどサービスを育てていくことに対するヒントがいっぱいあってとても勉強になりました。</p>

<h3>@syachi / ゴミ収集カレンダー</h3>

<p>YAPCに応募されていたトークで、「札幌市のWebページに掲載されている&#8221;ごみ収集日カレンダー&#8221;をperlを使ってparseする」という暮らしを便利にするコンセプトが面白そうだなと思いお願いしました。</p>

<p>まさかの号泣ネタもありながら、ごみ収集カレンダーと戦っていく様子がとても面白かったです。</p>

<h3>@masuidrive / wri.pe</h3>

<p>wri.peは個人的にも愛用しているシンプルで使いやすくて完成度の高いアプリで、個人でどうやって作っていったのかという過程に興味があって今回お願いしました。</p>

<p>GW中に作ろうと思って作り始めてそこからたくさんの人に使われていく流れが面白く、デザインを考えた時の話などとても参考になりました。</p>

<h3>@hika69 / プライベートで3年間チーム開発した話</h3>

<p>CastoやStoryBoardsなど面白いサービスたくさん作られていて、Rendrなど色々な技術を使われているのもすごいなぁと思ってお願いしました。あとuzullaさんの強烈なpushもありｗ</p>

<p>技術をサービスに活用するのが本当に上手いなぁというのと、チーム開発に対するヒントがたくさん詰まった発表でとても勉強になりました。</p>

<h3>@sugyan / ttyrecからGIFアニメを作る話</h3>

<p>golangを学びながらサービスを作ってしまって、その上Web対応もやってすごいなぁと思ってお願いしました。</p>

<p>デモを交えながらの発表で、さらっとすごいことをやっていてさすがだなという発表でした。</p>

<h3>@razokulover / GIFMAGAZINEの話</h3>

<p>GIFMAGAZINEをはじめ面白いサービスをたくさん作られていて、どういうことを考えてサービスを作っていることに興味があってお願いしました。</p>

<p>GIFアニメ好きのために作るという明確な意思がGIFMAGAZINEを支えていて、一番使って欲しい人のためにサービスを作ることの大事さを感じる発表でした。</p>

<h3>@yositosi / togetter</h3>

<p>AdminsBarというpodcastで出演されているのを聞いて是非話を聞いてみたいと思ったのでお願いしました。</p>

<ul>
<li><a href="http://admins.bar/2/">http://admins.bar/2/</a></li>
</ul>


<p>togetter誕生からたくさんの人に使われていくまでの流れをpodcastの時と同様に面白くTalkされていてあっという間の時間でした。</p>

<p>podcast聴いてない人はWebサービスを作る楽しさが詰まっているので是非聴いてみてください！</p>

<h3>@debility / クイズを支える技術</h3>

<p>YAPCのTalkにも応募されていて、デモが面白いという噂を聞きお願いしました。</p>

<p>ネタ満載でトリに相応しい盛り上がりで楽しませてもらいました！</p>

<p>(楽しみ過ぎてて最後の締めの挨拶何も考えてなかったのは失敗でしたが&hellip;)</p>

<h2>まとめ</h2>

<p>自分がTalkを聞きたい人に集まってもらったので本当に楽しかったです！</p>

<p>発表者の方、そしてスタッフの方本当にありがとうございました！！</p>

<p>すこしでもWebアプリ作ろうと思った人がいれば嬉しいです！</p>

<p>※参加してくださった方は感想を書いて頂けると嬉しいです。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「Yコンビネーター シリコンバレー最強のスタートアップ養成スクール」を読んだ]]></title>
    <link href="http://blog.koba04.com/post/2014/07/25/book-review-of-the-launch-pad/"/>
    <updated>2014-07-25T00:06:17+09:00</updated>
    <id>http://blog.koba04.com/post/2014/07/25/book-review-of-the-launch-pad</id>
    <content type="html"><![CDATA[<p>37Signals本を読んだりしていて、たまたま本屋でこの本を発見して読んでみました。</p>

<p>Yコンビネーターは「ハッカーと画家」やLispプログラマーとしても有名なポール・グレアムがやっているスタートアップを支援する組織で、この本はそこに集まった起業家が3ヶ月後のデモ・デーに挑むまでのドキュメンタリーが中心の内容になっています。</p>

<!-- more -->


<h2>エンジニア目線で</h2>

<p>ここに起業家として登場するのはまさに選ばれた天才ばかりで、ハッカーも多くいますが技術的な内容はほとんどないです。</p>

<p>この本では37Signalsの本にあるようなチームのあり方についてなどもありますが、それよりもサービスのアイデアの生み出し方やマネタイズ、どう育てていくのかといったことのヒントを創業者の悩みやポール・グレアムの助言を通じて学ぶことが出来ます。</p>

<p>また、Yコンビネーターの先輩として、<a href="https://www.dropbox.com/">Dropbox</a>や<a href="https://www.heroku.com/">Heroku</a>などのメンバーが登場したり、
今回の創業者の中にも<a href="https://www.mongohq.com/">MongoHQ</a>や<a href="https://parse.com/">Parse</a>や<a href="http://www.codecademy.com/">Codecademy</a>がいてそのエピソードはとても興味深いです。</p>

<p>SnapjoyのメンバーはHerokuを使っていて、サービスが急成長しているときにDynoを急いで増やしてもらうためにHerokuの創業者にインスタントメッセージで直接お願いしたというエピソードもあったりします。</p>

<p>プログラミングしてサービスを作れることがどんなに強みであるかやその楽しさを改めて再確認させてくれます。</p>

<h2>リアルさ</h2>

<p>この本は密着取材という形で書かれていて、全64チームのうちいくつかメインとなるチームがありながら様々なチームが登場し、海外からの参加者や結婚して子どももいる人など様々なバックグラウンドを持っている人たちが登場します。</p>

<p>それらについて、とてもリアルにまるでその場にいるような形で書かれています。基本的には3ヶ月間ひたすらコードを書き続けるという感じなのでドラマチックなことが何か起きるわけではなく、サービスを作りポール・グレアムなどに相談してまた作るということを繰り返していく感じです。</p>

<p>ですが、実際にサービスに対してどういう考えを持っているかといった部分や何に力を注いでいるのかといった部分がとても勉強になります。</p>

<h2>ヒットするサービス</h2>

<p>ポール・グレアムでもヒットするサービスを見極めることは難しいので少額(数万ドル)でも全チームに投資していたり、デモ・デーまでの3ヶ月でもサービスを何度も変えて作り直すチームがいくつもあったり、サービスを作ることの難しさや厳しさを感じさせてくれます。</p>

<h2>分析</h2>

<p>取材した内容をただ書いているだけでなく、なぜシリコンバレーである必要があるのかといった疑問に対する分析も含まれていてそれもとても面白いです。</p>

<h2>最後に</h2>

<p>400ページ以上となかなかのボリュームですが、読み始めると面白くて一気に最後まで読んでしまう本でした。</p>

<p>サービスを作っている人が読むと、開発者であっても得られるものが多い本だと思いました。</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=musicfanclub-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4822249468" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[天下一クライアントサイドJS MV*レームワーク武道会で話しました #ten1club]]></title>
    <link href="http://blog.koba04.com/post/2014/07/12/talked-at-ten1club/"/>
    <updated>2014-07-12T23:13:39+09:00</updated>
    <id>http://blog.koba04.com/post/2014/07/12/talked-at-ten1club</id>
    <content type="html"><![CDATA[<p><a href="http://connpass.com/event/6910/">http://connpass.com/event/6910/</a></p>

<p>「天下一クライアントサイドJS MV*フレームワーク武道会」でMarionette.jsについてのLTとパネルディスカッションをさせて頂きました。</p>

<!-- more -->


<p>JavaScriptについて外部で話すの初めてだったのでドキドキしてましたが本当にとても面白いイベントでした。</p>

<p><a href="https://twitter.com/yosuke_furukawa">@yosuke_furukawa</a>さんに感謝です。++</p>

<p>ありがとうございます！</p>

<h2>LT</h2>

<p>Marionette.jsについてを簡単に説明した感じです。面白みがないですが&hellip;。興味があれば見てみてください。</p>

<p><a href="https://speakerdeck.com/koba04/5fen-dewakarumarionette-dot-jsfalseiitokoro">5分でわかるMarionette.jsのいいところ</a></p>

<p>他の方の発表もみんな面白かったです。Reactが気になっていたのでその辺りも少し聞けてよかったです。</p>

<h2>パネルディスカッション</h2>

<p><a href="https://twitter.com/mizchi">@mizchi</a>さん、<a href="https://twitter.com/damele0n">@damele0n</a>さん、<a href="https://twitter.com/hokaccha">@hokaccha</a>さん、<a href="https://twitter.com/teppeis">@teppeis</a>さんという豪華なメンバーに紛れて参加させて頂いたいのですが、うまく伝えられず反省する点もありましたが聞いていてとても楽しくてあっという間の1時間でした。また機会があれば続きをやりたいです。</p>

<h2>懇親会</h2>

<p>色んな方に声を掛けて頂き、面白い話がいっぱい聞けて楽しかったです。ブログ見たと言ってもらえたのが嬉しかったのと、意外とMarionette.js使われていて同じようなところで悩んでるなぁとわかってよかったです。懇親会後のWebComponents話も面白かったです。</p>

<h2>最強のフレームワーク??</h2>

<p>まぁぶっちゃけ、このフレームワーク使っておけばいいというものはなくて、「誰が触るのか」、「どんなアプリなのか」によって全く答えは変わってくるので、選択肢を自分の中で持っておくことが大切なんじゃないかなと思いました。</p>

<h2>蛇足</h2>

<p>ちなみに個人的には、Vue.js、browserify辺りを使って、テストはkarma、mocha、power-assertとか組み合わせるのが今は好きです。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Release karma-say-reporter]]></title>
    <link href="http://blog.koba04.com/post/2014/06/29/release-karma-say-reporter/"/>
    <updated>2014-06-29T01:14:36+09:00</updated>
    <id>http://blog.koba04.com/post/2014/06/29/release-karma-say-reporter</id>
    <content type="html"><![CDATA[<p>最近karmaを使っているのもあって、karma-say-reporterっていうのをリリースしました。</p>

<p><a href="https://www.npmjs.org/package/karma-say-reporter">https://www.npmjs.org/package/karma-say-reporter</a></p>

<!-- more -->


<p>karmaでテストの結果によって通知するものとしては、<a href="https://www.npmjs.org/package/karma-mp3-reporter">karma-mp3-reporter</a>というものがありますが、好きな言葉を指定したいということでOSXにあるsayコマンドで結果を通知してくれるものです。</p>

<h2>Config</h2>

<p>こんな感じでreportersにsayを追加して、successとfailのときのメッセージを指定出来るようになっています。また、sayコマンドの-vで指定出来るvoiceの種類も設定出来るようになっています。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// karma.conf.js</span>
</span><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">config</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;progress&#39;</span><span class="p">,</span> <span class="s1">&#39;say&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">sayReporter</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">success</span><span class="o">:</span> <span class="s2">&quot;test all successs&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">fail</span><span class="o">:</span> <span class="s2">&quot;test failed&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">voice</span><span class="o">:</span> <span class="s2">&quot;Agnes&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Kyoko for Japanese</h2>

<p>デフォルトだと日本語を指定することが出来ないのですが、環境設定の「音声入力と読み上げ」からKyokoさんを追加すれば日本語を指定できるようになるので、Kyokoさんを追加した後に下記のように設定することで日本語で通知することも出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// karma.conf.js</span>
</span><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">config</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;progress&#39;</span><span class="p">,</span> <span class="s1">&#39;say&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">sayReporter</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">success</span><span class="o">:</span> <span class="s2">&quot;やったね&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">fail</span><span class="o">:</span> <span class="s2">&quot;テストこけてるで&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">voice</span><span class="o">:</span> <span class="s2">&quot;Kyoko&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Linux&hellip;</h2>

<p>ソース見てもらえれば分かる通り、voiceを覗いてはただsayコマンドに渡してるだけなので、独自にsayコマンドを定義してあげれば多分動くと思います。</p>

<p>なので汎用的なreporterとしても使えるかもしれないです。</p>

<h2>Enjoy!</h2>

<p>Karmaのpluginはまだ未開の地な感があるのでいろんなplugin作っていくと楽しくテスト書けそうでいいですね！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Karma for JavaScript test runner]]></title>
    <link href="http://blog.koba04.com/post/2014/06/23/karma-for-javascript-test-runner/"/>
    <updated>2014-06-23T00:48:32+09:00</updated>
    <id>http://blog.koba04.com/post/2014/06/23/karma-for-javascript-test-runner</id>
    <content type="html"><![CDATA[<p><img src="http://blog.koba04.com/images/karma.png" title="'karma'" ></p>

<p>今まではなんとなくtestemを使っていたのですが、Karmaを検討する必要があったので試してみました。</p>

<p>サンプルの設定などは↓で見ることが出来ます。</p>

<ul>
<li><a href="https://github.com/koba04/backbone-boilerplate">https://github.com/koba04/backbone-boilerplate</a></li>
</ul>


<!-- more -->


<h2>testem to karma</h2>

<p>これまでは業務でもtestemを使っていて、テストの数が少ないうち(1000以下)は問題なかったのですが、
段々テストが増えてくるとCPU100%になってテストが走るブラウザが固まることが増えてきて辛い感じになってきました。</p>

<p>そんなときに下記の記事を見て同じような現象だなと思いKarmaを試してみることにしました。</p>

<ul>
<li><a href="http://developer.cybozu.co.jp/tech/?p=7089">http://developer.cybozu.co.jp/tech/?p=7089</a></li>
</ul>


<h2>Installation</h2>

<p>インストールは<strong>npm install karma</strong>するだけです。</p>

<p>globalでkarmaのコマンドが使いたい場合はgruntのように<strong>npm install -g karma-cli</strong>します。</p>

<ul>
<li>karmaはglobalに入れません。</li>
</ul>


<h2>Easy to use</h2>

<p>テストを読み込むためのHTMLを用意して色々書いたりする必要がなくて、<strong>karma init</strong>してframeworkやテスト対象のファイルを指定して、
<strong>karma start</strong>するだけで変更を監視しての自動テストを行うことが出来ます。簡単です。</p>

<h2>Configration</h2>

<p>最初の設定は、<strong>karma init</strong>することで対話的に作成することが出来て、終了すると<strong>karma.conf.js</strong>が作成されます。</p>

<p>ちなみに<strong>karma init karma.conf.coffee</strong>のように拡張子をcoffeeにして指定することでcoffeescriptで作成することも出来ます。</p>

<p>生成されたファイルはこんな感じで、使うフレームワークや対象ファイル、実行するブラウザ、出力形式、ファイルの変更を監視して自動でテストするか、テスト終了後もプロセスを残すかどうかなどを設定します。</p>

<ul>
<li>設定項目の抜粋</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">config</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// ベースとなるパス</span>
</span><span class='line'>    <span class="nx">basePath</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 使用するフレームワーク。ここから探せる https://npmjs.org/browse/keyword/karma-adapter</span>
</span><span class='line'>    <span class="nx">frameworks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;mocha&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 読み込むファイル(テスト対象のファイルやテストファイルなど)。</span>
</span><span class='line'>    <span class="nx">files</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;js/*.js&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// filesから除外したファイル</span>
</span><span class='line'>    <span class="nx">exclude</span><span class="o">:</span> <span class="p">[],</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// テストの実行前に差し込む処理。ここから探せる https://npmjs.org/browse/keyword/karma-preprocessor</span>
</span><span class='line'>    <span class="nx">preprocessors</span><span class="o">:</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// テストの結果を出力する形式。ここから探せる https://npmjs.org/browse/keyword/karma-reporter</span>
</span><span class='line'>    <span class="c1">// &#39;dots&#39;と&#39;progress&#39;は最初から使える</span>
</span><span class='line'>    <span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;progress&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 使用するport</span>
</span><span class='line'>    <span class="nx">port</span><span class="o">:</span> <span class="mi">9876</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 出力に色を付けるか</span>
</span><span class='line'>    <span class="nx">colors</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// ログレベル: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG</span>
</span><span class='line'>    <span class="nx">logLevel</span><span class="o">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">LOG_INFO</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// ファイルの変更を監視してテストを自動的に実行するかどうか</span>
</span><span class='line'>    <span class="nx">autoWatch</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// テストするブラウザ。ここから探せる https://npmjs.org/browse/keyword/karma-launcher</span>
</span><span class='line'>    <span class="nx">browsers</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;Chrome&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// trueにすると一回テストを実行するとプロセスが終了する</span>
</span><span class='line'>    <span class="c1">// CIのときに使ったり。</span>
</span><span class='line'>    <span class="nx">singleRun</span><span class="o">:</span> <span class="kc">false</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>その他では、<strong>autoWatchBatchDelay</strong>を使うと指定したms内での変更をまとめて一つとして扱ってくれるので、監視対象のファイルが短い時間に連続して更新されて複数回テストが実行される場合は、この値を長めにするといいかもしれません(defaultは250ms)。</p>

<h2>Browsers</h2>

<p>ブラウザはChromeやSafariやPhantomJSなど色々ありますので、<strong>karma-xxx-launcher</strong>で探すことが出来ます。</p>

<h2>Frameworks</h2>

<p><strong>mocha</strong>や<strong>jasmine</strong>や<strong>qunit</strong>などの場合は<strong>karma-mocha</strong>のようにすでにadapterが用意されているので、
ここにframeworkを設定に書いてadapterをインストールするだけで使うことが出来ます。</p>

<h3>karma-mocha-debug</h3>

<ul>
<li><a href="https://github.com/maksimr/karma-mocha-debug">https://github.com/maksimr/karma-mocha-debug</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">frameworks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;mocha-debug&#39;</span><span class="p">,</span> <span class="s1">&#39;mocha&#39;</span><span class="p">],</span>
</span></code></pre></td></tr></table></div></figure>


<p>testem+mochaでやっている時に、ブラウザで結果を確認してそこから指定したテストだけを再実行出来るのが便利だったので
karmaでも出来ないないかな思って調べるみると、karma-mocha-debugを使うと出来るようでした。
karmaのブラウザからdebugボタンを押してdebug.htmlを開くと見ることが出来ます。素晴らしい！</p>

<p><img src="http://blog.koba04.com/images/karma-mocha-debug.png" title="'karma mocha debug'" ></p>

<h2>Preprocessors</h2>

<p>preprocessorsを指定することで<strong>files</strong>に書いたファイルに対してテストを実行する前に処理を挟むことが出来、柔軟なテストの設定が可能です。</p>

<p>coffeescriptのコンパイルだったりbrowserifyのビルドなどで<strong>karma-xxxx-preprocessor</strong>で探すことが出来ます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">preprocessors</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="s1">&#39;**/*.coffee&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;coffee&#39;</span><span class="p">]</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>karma-html2js-preprocessor</h3>

<ul>
<li><a href="https://github.com/karma-runner/karma-html2js-preprocessor">https://github.com/karma-runner/karma-html2js-preprocessor</a></li>
</ul>


<p>また、karma-html2js-preprocessorというものもあって、これを使うと指定したHTMLを<strong>window.__html__[&lsquo;name.html&rsquo;]</strong>に入れてくれるので、fixtureデータとして使うことが出来ます。アプリのテストだとどうしてもDOMが必要になるので便利です。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">files</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>  <span class="s1">&#39;**/*.html&#39;</span>
</span><span class='line'><span class="p">],</span>
</span><span class='line'><span class="nx">preprocessors</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="s1">&#39;**/*.html&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;html2js&#39;</span><span class="p">]</span>
</span><span class='line'><span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">before</span> <span class="nf">-&gt;</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="nb">window</span><span class="p">.</span><span class="nx">__html__</span><span class="p">[</span><span class="s">&#39;fixture.html&#39;</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Reporters</h2>

<p>reporterを指定することで、様々な形式でテストの結果を出力したり通知したりすることが出来ます。</p>

<p>karma-xxxx-reporterで探すことが出来て、
nyanやtapやmocha形式のような出力形式のカスタマイズ以外にも、結果をgrowlやmp3で通知したりcoverageを計測したりなどさまざまなreporterがあります。</p>

<h3>karma-nyan-reporter</h3>

<ul>
<li><a href="https://github.com/dgarlitt/karma-nyan-reporter">https://github.com/dgarlitt/karma-nyan-reporter</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;nyan&quot;</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>nyanの形式でテストを出力してくれるのでもっとテスト書こうという気持ちになっていいです。(バグってたのpull reqして直してもらいました&hellip;)</p>

<p><img src="http://blog.koba04.com/images/karma-nyan-reporter.gif" title="'karma nyan reporter'" ></p>

<h3>karma-growl-reporter,karma-osx-reporter</h3>

<ul>
<li><a href="https://github.com/petrbela/karma-osx-reporter">https://github.com/petrbela/karma-osx-reporter</a></li>
<li><a href="https://github.com/karma-runner/karma-growl-reporter">https://github.com/karma-runner/karma-growl-reporter</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;growl&quot;</span><span class="p">,</span> <span class="s2">&quot;osx&quot;</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>GrowlかNotificationCenterでテストの結果を通知してくれるので便利です。</p>

<h3>karma-mp3-reporter</h3>

<p><a href="https://github.com/x2es/karma-mp3-reporter">https://github.com/x2es/karma-mp3-reporter</a></p>

<p>成功したとき、失敗したときに好きな音が流せて楽しいですね。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;mp3&quot;</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nx">mp3Reporter</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">red</span><span class="o">:</span> <span class="s2">&quot;go-to-hell.mp3&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">green</span><span class="o">:</span> <span class="s2">&quot;happy.mp3&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>karma-mocha-reporter</h3>

<p><a href="https://github.com/litixsoft/karma-mocha-reporter">https://github.com/litixsoft/karma-mocha-reporter</a></p>

<p>mochaの形式で出力してくれるreporterなのですが、describeとitに与える説明をObjectが持っている関数名にすると&#8221;Cannot assign to read only property&#8221;というエラーになるので注意が必要です(describe &ldquo;method名&#8221;の形式で書いていたのでハマった&hellip;)。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="c1"># Error!!!!</span>
</span><span class='line'><span class="nx">describe</span> <span class="s">&quot;constructor&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>  <span class="nx">it</span> <span class="s">&quot;xxxx&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="p">...</span>
</span></code></pre></td></tr></table></div></figure>


<p>原因としては、下記のようにdescriptionをpropertyとして使っているため、constructorやtoStringとかを指定すると関数が取得されて、そこにnameを追加しようとしてエラーになる感じです(use strictが指定されてるためエラーになる)。</p>

<ul>
<li><a href="https://github.com/litixsoft/karma-mocha-reporter/blob/master/index.js#L178-L182">https://github.com/litixsoft/karma-mocha-reporter/blob/master/index.js#L178-L182</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">path</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">suite</span><span class="p">,</span> <span class="nx">description</span><span class="p">,</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">suite</span><span class="p">[</span><span class="nx">description</span><span class="p">]</span> <span class="o">||</span> <span class="p">{};</span>
</span><span class='line'>        <span class="nx">suite</span><span class="p">[</span><span class="nx">description</span><span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">item</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">description</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Conclution</h2>

<p>というわけでKarmaを試したのですが、思った以上に簡単に始めることが出来て、<strong>preprocessors</strong>や<strong>reporters</strong>などの仕組みがあってプラガブルな感じがとてもいいなぁと思いました。</p>

<p>今後もっとpluginが増えていくことに期待です。</p>

<h2>おまけ</h2>

<h3>power-assert対応しました</h3>

<p>もともとbrowserifyを使っていたので、transformにespowerifyを指定してあとはテストをassertに書き換えるだけだったのでとても簡単に出来てよかったです！素晴らしい！</p>

<p>コミットログはこの辺り。 <a href="https://github.com/koba04/backbone-boilerplate/commit/2fadec43e46f99cce0d3d828c66d4b12d758f4f0">https://github.com/koba04/backbone-boilerplate/commit/2fadec43e46f99cce0d3d828c66d4b12d758f4f0</a></p>

<p><img src="http://blog.koba04.com/images/power-assert.png" title="'power-assert'" ></p>
]]></content>
  </entry>
  
</feed>
